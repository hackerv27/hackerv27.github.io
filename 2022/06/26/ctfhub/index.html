<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Hubcry | 早安Flag</title><meta name="keywords" content="wp"><meta name="author" content="hackerv27,you_fr@163.com"><meta name="copyright" content="hackerv27"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="CTFHub题是刷了，但不代表我都会了🤷✌😱 🎈🎈🎈 you_raise_me_up四⭐网鼎青龙 key: 标准离散对数问题、sympy数学计算库 题目： 12345678910111213#!&#x2F;usr&#x2F;bin&#x2F;env python# -*- coding: utf-8 -*-from Crypto.Util.number import *import randomn &#x3D; 2 ** 51">
<meta property="og:type" content="article">
<meta property="og:title" content="Hubcry">
<meta property="og:url" content="http://hackerv27.github.io/2022/06/26/ctfhub/">
<meta property="og:site_name" content="早安Flag">
<meta property="og:description" content="CTFHub题是刷了，但不代表我都会了🤷✌😱 🎈🎈🎈 you_raise_me_up四⭐网鼎青龙 key: 标准离散对数问题、sympy数学计算库 题目： 12345678910111213#!&#x2F;usr&#x2F;bin&#x2F;env python# -*- coding: utf-8 -*-from Crypto.Util.number import *import randomn &#x3D; 2 ** 51">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://hackerv27.github.io/img/7.png">
<meta property="article:published_time" content="2022-06-26T15:24:52.000Z">
<meta property="article:modified_time" content="2022-08-09T09:32:12.394Z">
<meta property="article:author" content="hackerv27">
<meta property="article:tag" content="wp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://hackerv27.github.io/img/7.png"><link rel="shortcut icon" href="/img/1.jpg"><link rel="canonical" href="http://hackerv27.github.io/2022/06/26/ctfhub/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: {"limitDay":30,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: hackerv27","link":"链接: ","source":"来源: 早安Flag","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Hubcry',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-08-09 17:32:12'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.2.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/1.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">13</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">6</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-graduation-cap"></i><span> Blog</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> categories</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> tags</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> archives</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/7.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">早安Flag</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-graduation-cap"></i><span> Blog</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> categories</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> tags</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> archives</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Hubcry</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-06-26T15:24:52.000Z" title="发表于 2022-06-26 23:24:52">2022-06-26</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-08-09T09:32:12.394Z" title="更新于 2022-08-09 17:32:12">2022-08-09</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Crypto/">Crypto</a></span></div><div class="meta-secondline"></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="CTFHub"><a href="#CTFHub" class="headerlink" title="CTFHub"></a>CTFHub</h1><p>题是刷了，但不代表我都会了🤷✌😱</p>
<p>🎈🎈🎈</p>
<h2 id="you-raise-me-up"><a href="#you-raise-me-up" class="headerlink" title="you_raise_me_up"></a>you_raise_me_up</h2><p>四⭐网鼎青龙</p>
<p>key: 标准离散对数问题、sympy数学计算库</p>
<p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">import random</span><br><span class="line"></span><br><span class="line">n = 2 ** 512</span><br><span class="line">m = random.randint(2, n-1) | 1</span><br><span class="line">c = pow(m, bytes_to_long(flag), n)</span><br><span class="line">print &#x27;m = &#x27; + str(m)</span><br><span class="line">print &#x27;c = &#x27; + str(c)</span><br><span class="line"></span><br><span class="line"># m = 391190709124527428959489662565274039318305952172936859403855079581402770986890308469084735451207885386318986881041563704825943945069343345307381099559075</span><br><span class="line"># c = 6665851394203214245856789450723658632520816791621796775909766895233000234023642878786025644953797995373211308485605397024123180085924117610802485972584499</span><br></pre></td></tr></table></figure>

<blockquote>
<p>代码意思：求满足m的bytes_to_long(flag)次方，对n取模的flag值</p>
<p>pow函数是计算x的y次方，如果z在存在，则再对结果进行取模，其结果等效于pow(x,y) %z</p>
<p>ps：各个环境下%运算符的含义不同，比如c&#x2F;c++，java 为取余，而python则为取模</p>
</blockquote>
<p>构造脚本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">m = 391190709124527428959489662565274039318305952172936859403855079581402770986890308469084735451207885386318986881041563704825943945069343345307381099559075</span><br><span class="line">c = 6665851394203214245856789450723658632520816791621796775909766895233000234023642878786025644953797995373211308485605397024123180085924117610802485972584499</span><br><span class="line">n = 2 ** 512</span><br><span class="line"></span><br><span class="line">import sympy</span><br><span class="line">flag=sympy.discrete_log(2**512,c,m)#求离散对数</span><br><span class="line">import binascii</span><br><span class="line">print(binascii.unhexlify(hex(flag)[2:]))#将答案的十六进制转出来</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>binascii — 二进制和 ASCII 码互转</p>
<h3 id="sage之离散对数求解"><a href="#sage之离散对数求解" class="headerlink" title="sage之离散对数求解"></a>sage之离散对数求解</h3><p>sage中求解离散对数我目前知道的四个函数：</p>
<p>(1)discrete_log：通用的求离散对数的方法：discrete_log(a,base,ord,operation)</p>
<p>(2)discrete_log_rho：求离散对数的Pollard-Rho算法：discrete_log_rho(a,base,ord,operation)</p>
<p>(3)discrete_log_lambda：求离散对数的Pollard-kangaroo算法（也称为lambda算法）：discrete_log_lambda(a,base,bounds,operation)</p>
<p>(4)bsgs：小步大步法：bsgs(base,a,bounds,operation)</p>
<blockquote>
<p>参数说明：求解以base为底，a的对数；ord为base的阶，可以缺省，operation可以是’+’与’<em>‘，默认为’</em>‘；bounds是一个区间(ld,ud)，需要保证所计算的对数在此区间内。</p>
</blockquote>
<p>待学习🎈</p>
<h2 id="shanghai"><a href="#shanghai" class="headerlink" title="shanghai"></a>shanghai</h2><p>三⭐网鼎</p>
<p>key：维吉尼亚  vigenère</p>
<blockquote>
<p>打开题目后，有点恍惚</p>
<p>大致浏览，查找flag、key、{ }</p>
<p>可以发现一段文本’{‘ vvj ‘zvkvrmtudabiecveaaxpp’ grq ‘}’    猜测有flag</p>
<p>得知道这是vigenere类型（这我怎么知道？？？或许看vvj？）</p>
<p>还要找到密钥（👍）看了一位uu写的找密钥过程，看得我有点迷糊</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/ta0tie/articles/15493969.html">WP-Crypto-shanghai-维吉尼亚密码 - ta0tie - 博客园 (cnblogs.com)</a></p>
<p>密钥：vigenereicq</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">bju lcogx fisep vjf pyztj sdgh 13 gifc qsxw. pkiowxc</span><br><span class="line">glv jqtio ekpy-hfgcouibkh qijgzkfoqur bj r twnovtvlnfvxqe sdxnie arw nqhhcregiu fg nujv hegxzwbc qgjkvgm rvwwdy 1467 ith hwvh i ouoir gvtyiz fynk zs fazxkj rzbcirr tmxjum irtuesibu. qgjkvgm&#x27;j wgujzu uryc jaqvscmj eytyejgjn ilxrv jidghvt csehj, evf irqzguij amtu dvjmpekil do rzoxvrx xpg bzbzie sw xpg sjzxiftfrlkdb irtuesib kd opk gvtyizvusb. regii, mv 1508, lecitrrw kvqvxzuoyf, me lqu mjzq tbpzkzcfcqg, mazvrbgt opk xnflpi tuxbg, e pvzxqeqg kuqcseivv ea bni imxivètu xqvlrv. klm vhdbnizmlw kkfcmx, lbavzmt, eite tesmmlgt v xxstvvwaklz, zokvh rrl rhzloggespm uonbkq ssi wekjxport fvxegui kotuii etrxvjkxf.[gzxivyjv tirhvh]</span><br><span class="line"></span><br><span class="line">ejqo qy rba brwyd va zlr zzkmpèhz kotuii aiu emqmmaecpg funkxmoiu fg iyjdgr oekxqujv jkpyejs qp xda 1553 hsbo ce kkvmi jiy wzk. okeqit fnxkmavq wmrpnwf.[4] lm dkdtz ycse xpg jvjapn vvgbc ea bxmglvqqwi wcz eqhvh i tukmgxvrx &quot;gwwdomxwvke&quot; (e sgo) ow yavxtl kkfcmx eytyejgjn mbiec cibvum. enieirw inrzzzm nru xzkjcmsmhw lwmf q aqdiq trxbghi wl whfjxqvkoqurf, fvptcij&#x27;a yguidi ugqib zlr trxbghi wl whfjxqvkoqurf gfytf rz mgwvpp gpcdbmj, wvqgpg do nmripxzro c dze qil. ovca yumm zccmtetno nqtkyi nszfi jz ylbvk tptqnmy, oasnr bq rjbn tnvkmmu yi ijznrti, wt jmitwzmkxmf &quot;epb uj oeeh&quot; ineio cmgl klm ounagkr. fvptcij&#x27;a siglfh bjkn zkuhmiil ujmwtk fityzkjt nuv brcc bju fme. ef mk ma tugizmiicc mcit bu wrglvm c icwxx xip tptqnm, yypl rw ja q kzkzvslw xtyqizi psezmtivbosa, fvptcij&#x27;a ycfxvq eci xwtwvhvvidbt uuvr wvgctu.[xqzegmfr vguymj]</span><br><span class="line"></span><br><span class="line">fyezwm fu qqmiaèvv tcdbdaniq lzw lgixzotgmfr wh q nqsmyei fcv iozurtii ecvefme gvtyiz duawxi glv gwwho wl lrric qky jn lvnrti, qp 1586.[5] bvbkv, vr klm 19vx xmtxhvp, xpg yidkrgmfr wh rztrefs&#x27;j gqrxzz cef qzwivjmqhygiu xw xybmtèvr. hrzqf avpt, ma lzw jqef, bni psuijtuvskvf prqmpjzl zlr qzwivjmqhygmfr ja ivgort xyeb jynbuvl lrh &quot;qidjzkh glzw qofjzzeax tsvvhdjaxvse evf yiazinh eeugt v zkkeijwqxu vvj iyidivvqmg imclvv nqh cqs [zvkvrèzg] jcwaku lv lif djbnmak ks lq mdbn mg&quot;.[6]</span><br><span class="line"></span><br><span class="line">xyi dkwzvèxi pmglmt wvqtiq e iixwjvbosa jfv jgyio kbpigxqqdvtrc fxisvi. djbkh nyklwt qil seglvqivyxqgr plrvtgi gczavhxi lqtbaur (yinma eqmzupy) grptgt opk zvkvrèzg sdxnie yefzgqfihpr me lqu 1868 fdmii &quot;glv etrxvjkx pmglmt&quot; yi i ilvpuvmp&#x27;i himemmei. qp 1917, ixqkrgmwmk cczzognr uiaehdjkh glv zqiuièzk gvtyiz ci &quot;duvsfwzftg ea bxeawcebkei&quot;.[7][8] bneg vvtcvqoqur jej rwv tzakviiu. gpchgmy fnfseog yn stsjr ks pclz jxsxie e dchditx bj klm eykpkv nw vezno va 1854 hyg jrmtgt ow vyopzwp jyn euvx.[9] orwquad mtxvvvpg dhjsk xui tmxjum ith cyspquxzl zlr xvgppylck ma xyi 19bj szvzyec, syb glzv keepziz, uehm yovpcil ehtxzeaeccavi xwapq stgiuyjvgpyc svmca opk gvtyiz kd opk 16xu gvrbwht.[6]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">kxccxfkzcfcqi wymui zwbz cyiq ej e kcbxcregmfr ikt wg zlr wnmau qmue frxnimp 1914 qil 1940.</span><br><span class="line">zlr zzkmpèhz kotuii ma uyhxri rrfyoj jj jk e smvpl eykpkv vj zx qu knmj ma gfrrwdxbosa azxp eykpkv qmjoa.[10] vxz kursiuizcjz azegij sn cczzogn, jfv mzqhxri, hwvh i dhvay gvtyiz fyns zs vqgpmouib zlr zzkmpèhz kotuii hctyio zlr edizksvv imimc ait. jcm isajvhmtqxg&#x27;y qrwjeogi rmxi sei jzqc nmivrx, rrl vxz ctmbr iiowbvzrc pvrgsgt dby qrwjeogi. opxshkyscv jcm cee, xyi kqdamjieeki tgqymxwumg tzkcvzopl vvpqgt pxur gliim mut xnvnwvw: &quot;ucdxpkwgii ftwva&quot;, &quot;kuqcpvxm xyxbuvl&quot; eeh, iu jcm cee grqm ve v krsfi, &quot;tsug hzbxmoykmwp&quot;.[11]</span><br><span class="line"></span><br><span class="line">wdthiex mizpqh bxmrh ks zgfvqx xui svwmui kotuii (gzgqoqtk glv zmtdvu–bmtieèvm eykpkv vr 1918), syb pe hizxrv nliv xz loh, glv gqrxzz cef wkmtn lpttieespm ve xzetgeeetaida. bierrq&#x27;a yems, nsjimiz, glzvzynpcc tgt ow zlr sei-bkcz xgh, n xyiwtuoqieypp-yvdhziqeopv gqrxzz.[12]</span><br><span class="line"></span><br><span class="line">jifgimxvyjv</span><br><span class="line"></span><br><span class="line">zlr zzkmpèhz awynvv sz xybmtèvr xrftg, qgau oasnr iu jcm zeoyce zgsoi, iea fv yagt awx iagicxvyjv grq hvgzafoqur.</span><br><span class="line">vr r gigivz imclvv, mcsc tkxgii sn vxz irtuesib ki npojgiu etqdb auqr rlqjgh jn vpngvw. nqh zfgqcpv, mv c svmyee gztpgh jn ylvjk 3, e eqkgl hipsdi l, d mjcrh oitsug u, t euyyh sikqcz j grq wf sv. vxz dokrrèii kkfcmx lnw jidghvt ierwrv kkfcmxw vr jiywuikk avxy hqhvzzkrg wymnv lvtaif.</span><br><span class="line"></span><br><span class="line">xf ivehtxz, e gespm qv vtvlnfvxa eqi jk yfiu, xmtczl g xnflpi tuxbg, zvkvrèzg ilcgvr si zqiuièzk xnfci. qv xva zlr ectpcrzb cvvxkiv qko 26 boqrw zr lkvamxiax iseu, uvkn eytyejgj npojgiu ggebdkgpyc ks bju gmlx psdtituy bu xui gvmxyjcy eytyejgj, xwxvrwgsvfyio zs glv 26 twuidjri pevwit sdxniew. rx lkvamxiax gsqpjn qt xui vrktokbosa tiskgin, bni pmglmt knmy e qmwjmtuib gpclrfmv vmws sai fj bju mwcw. glv etrxvjkx hwvh iv uvkn tbmex lgfzvjw br r vmruvbort ovceqhy.[koxnxzsv puzlkh]</span><br><span class="line"></span><br><span class="line">ssi ifccktk, whtgsag jciz xui gpikdomdx gs si mpsmgvxrh zw</span><br><span class="line"></span><br><span class="line">ivjvkqeghrav.</span><br><span class="line">vxz xkvfse wmptdvm xui diauqbm ilbsjia c azgcseh rrl tukmgxf mk yvvyg qz qnxtlmu jcm riakkl wh jcm vpnmexmzj, awx ikedttg, jcm qilafvl &quot;nuhwt&quot;:</span><br><span class="line"></span><br><span class="line">prqfrtgcjvri</span><br><span class="line">retl zqm nbgvgw nmbj q fme prxkiz. vxz zkwg sw xpg hje nsyhj xpg bzbziew r xw b (yi anmsxvh wttzz). gpglfyoj jcmxi nvv 26 oma hjey wusnr, i eeym cmyp lwm qdgg gw zeec sgon (lojsiiivv qgxneoikw) iu jcmxi nvv yvkgpm rigxvva kd opk orc jxzkdb, pkvr nlwb 5 muta: &#123;r, i, z, s, e&#125;. jtcw, &#x27;&#123;&#x27; vvj &#x27;zvkvrmtudabiecveaaxpp&#x27; grq &#x27;&#125;&#x27; jfv awsxmywvzv pmvjzzy ss xyi uginimi, fytgmuiddk prxkizu ea bni xip wbtyio cmyp si bcazv grq irgp ounagkr pvxbgh zvimclvvmf rt cymak zxa eemzkwcsehqpw fme vba. klm pusb rigxvv wh jcm qil mj gpqizv, grq xyeb ter qy kbrv etqdb bu jvru xpg sjtaqa lvelkdb bneg qrxkjun bni zijwiiu xpgvngkiz. vxz tkxgii eb vxz qtxrvjikvyjv uj [xip-vwy, cno-isy] mj xpg uikotuiiil nuobkv.</span><br><span class="line"></span><br><span class="line">ssi ifccktk, xui wmzuj gmzxrv fj bju ktgmaxvbb, c, yn xgmeiu aqvx g, bni smiwb nuobkv bj klm mut. bnieiwszg, hje r eah tstwci i uj glv zqiuièzk wdyrvm chz cyiq, rrqmno g. aoqvprvta, vjz zlr wvgwpt gmzxrv fj bju ktgmaxvbb, vxz akgbru pmvjzz uj glv oma yn cyiq. xyi tgjomx eg vfa m cdy kuphqe x qu n. opk vrwk sn vxz xrevrkifv yn mtgvtyizgt dv g wvqzpit vvanmbr:</span><br><span class="line"></span><br><span class="line">gpikdomdx:	nxkekmqolgaa</span><br><span class="line">ovc:	tgcjvrizsepm</span><br><span class="line">eykpkvgiox:	tzvjxbisvelz</span><br><span class="line">fuxzetgmfr qu fzzlseqvh ja wjqtk gs klm ter qt xui kejnu xwxvrwgsvfyio zs glv oma, vdvjmak klm renqzmbr fj bju xqvlrvkifv bzbzie me xpcj mwc eah klmp knqtk glv gwnkhv&#x27;y pnfvp iu jcm vpnmexmzj. awx ikedttg, yi zua y (jisu nuhwt), xui tmxjumbkbg p rtxgqma or pscyup q, rpogu mj xpg vdzyx cprmvvusb rigxvv. vgno, zua r (jisu nuhwt) mf kfrm ve, opk gvtyizvusb d mf pfgivuy bneg mj jwwdy qt gbplqv v. jccy x vw klm uuxwth cprmvvusb rigxvv.</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>实际上( •̀ ω •́ )y</p>
<p><a target="_blank" rel="noopener" href="https://www.guballa.de/vigenere-solver%E8%87%AA%E5%8A%A8%E8%A7%A3%E5%AF%86">https://www.guballa.de/vigenere-solver自动解密</a></p>
<p>直接全放进去就ok</p>
<blockquote>
<p>flag, ‘{‘ and ‘vigenereisveryeasyhuh’ and ‘}’ </p>
</blockquote>
<p>tip：论好工具的重要性😭</p>
<h2 id="little-RSA"><a href="#little-RSA" class="headerlink" title="little RSA"></a>little RSA</h2><p>三⭐CSICTF</p>
<p>key：Factor N</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">c=32949</span><br><span class="line">n=64741</span><br><span class="line">e=42667</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">c = 32949</span><br><span class="line">n = 64741</span><br><span class="line">e = 42667</span><br><span class="line">p = 101</span><br><span class="line">q = 641</span><br><span class="line">phi = (p - 1) * (q - 1)  # φ(n)</span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line">a = pow(c, d, n)  # c的d次方 mod n</span><br><span class="line">print(a)</span><br></pre></td></tr></table></figure>

<h3 id="RSA简单入门"><a href="#RSA简单入门" class="headerlink" title="RSA简单入门"></a>RSA简单入门</h3><blockquote>
<p>||参考：Xwhite</p>
<p>[<a target="_blank" rel="noopener" href="https://bbs.pediy.com/thread-266504.htm">原创]Crypto中RSA常用工具及python库说明-密码应用-看雪论坛-安全社区|安全招聘|bbs.pediy.com</a></p>
</blockquote>
<p>Ron Rivest、Adi Shamir、Leonard Adleman</p>
<p>RSA就是他们三人姓氏开头字母拼在一起组成的, 三个人名字要有印象，有些题目会用这三个名字，这样可以帮助我们快速判断题目。</p>
<p>RSA公开密钥密码体制的原理是：基于数论，我们能知道随便找两个大素数比较简单，但是如果给定两个大素数的乘积来进行因式分解是及其困难的，因此可以将乘积公开作为加密密钥。</p>
<h4 id="RSA公钥密码"><a href="#RSA公钥密码" class="headerlink" title="RSA公钥密码"></a>RSA公钥密码</h4><p>RSA公钥密码体制描述如下：<br> 1）选取两个大素数p和q，p和q保密<br> 2）计算n&#x3D;pq，φ(n)&#x3D;(p-1)(q-1)，n公开，φ(n)（欧拉函数值）保密<br> 3）随机选取正整数 1&lt;e&lt;φ(n)，满足gcd(e,φ(n)) &#x3D; 1，e是公开的加密密钥<br> 4）计算d，满足ed≡1(modφ(n))，d是保密的解密密钥</p>
<p>加密变换：c &#x3D; m^e mod n<br>解密变换：m &#x3D; c^d mod n</p>
<p>虽然n，e 是公开的，但是要想知道 d 的值，必须要将 n 分解来计算出 n 的欧拉函数值，而 n 是两个大素数 p，q 的积, 前面说过分解是及其困难的。 但是对于特定的情况可以使用特殊方法进行分解。<br> 上文以及下文会涉及到一些具体的数论知识，例如：中国剩余定理，同余求余运算，欧拉函数等，大家可以自行查询或者通过《信息安全数学基础》或《现代密码学》进行自学，本文主要针对CTF比赛中关于RSA常见的题型讲解。</p>
<blockquote>
<p>RSA简单示意图</p>
</blockquote>
<img src="/2022/06/26/ctfhub/1.png" class>

<img src="/2022/06/26/ctfhub/2.png" class>

<img src="/2022/06/26/ctfhub/3.png" class>

<img src="/2022/06/26/ctfhub/4.png" class>

<img src="/2022/06/26/ctfhub/5.png" class>

<h4 id="RSA常见题型"><a href="#RSA常见题型" class="headerlink" title="RSA常见题型"></a>RSA常见题型</h4><h5 id="最简单的"><a href="#最简单的" class="headerlink" title="最简单的"></a>最简单的</h5><p>解决 RSA 题目最简单，最暴力，就是直接分解 n。如果能够将 n 分解成功，得到 p，q 的取值，那么可求φ(n).  φ(n)&#x3D;(p-1)(q-1)<br>利用e，d 与 n 的欧拉函数满足 ed≡1(modφ(n))<br>通过欧几里得算法可以通过 e 与 n 的欧拉函数值从而求出 d，计算出解密密钥。<br>所以在知道 e，p，q 的情况下，就可以解出 d（其实啥都给了，就让你代数计算了）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">p = 3487583947589437589237958723892346254777</span><br><span class="line">q = 8767867843568934765983476584376578389</span><br><span class="line">e = 65537</span><br><span class="line">print gmpy2.invert(e, (p-1)*(q-1))</span><br><span class="line">#求d</span><br></pre></td></tr></table></figure>

<h5 id="利用公约数分解n"><a href="#利用公约数分解n" class="headerlink" title="利用公约数分解n"></a>利用公约数分解n</h5><p>如果在两次加密过程中使用的n1和n2具有相同的素因子，那么可以利用欧几里得算法直接将n1和n2分解。通过欧几里得算法可以直接求出n1和n2的一个最大公约数p：<br> gcd(n1,n2)&#x3D;p<br> 这样的话<br> q1 &#x3D; n1 &#x2F; p<br> q2 &#x3D; n2 &#x2F; p</p>
<blockquote>
<p>eg：2020-BJDCTF-Cypto-rsa</p>
</blockquote>
<p>题目提示e&#x3D;52361 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import getPrime,bytes_to_long</span><br><span class="line"></span><br><span class="line">flag=open(&quot;flag&quot;,&quot;rb&quot;).read()</span><br><span class="line"></span><br><span class="line">p=getPrime(1024)</span><br><span class="line">q=getPrime(1024)</span><br><span class="line">assert(e&lt;100000)</span><br><span class="line">n=p*q</span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line">c=pow(m,e,n)</span><br><span class="line">print c,n</span><br><span class="line">print pow(294,e,n)</span><br><span class="line"></span><br><span class="line">p=getPrime(1024)</span><br><span class="line">n=p*q</span><br><span class="line">m=bytes_to_long(&quot;BJD&quot;*32)</span><br><span class="line">c=pow(m,e,n)</span><br><span class="line">print c,n</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">output:</span><br><span class="line">12641635617803746150332232646354596292707861480200207537199141183624438303757120570096741248020236666965755798009656547738616399025300123043766255518596149348930444599820675230046423373053051631932557230849083426859490183732303751744004874183062594856870318614289991675980063548316499486908923209627563871554875612702079100567018698992935818206109087568166097392314105717555482926141030505639571708876213167112187962584484065321545727594135175369233925922507794999607323536976824183162923385005669930403448853465141405846835919842908469787547341752365471892495204307644586161393228776042015534147913888338316244169120  13508774104460209743306714034546704137247627344981133461801953479736017021401725818808462898375994767375627749494839671944543822403059978073813122441407612530658168942987820256786583006947001711749230193542370570950705530167921702835627122401475251039000775017381633900222474727396823708695063136246115652622259769634591309421761269548260984426148824641285010730983215377509255011298737827621611158032976420011662547854515610597955628898073569684158225678333474543920326532893446849808112837476684390030976472053905069855522297850688026960701186543428139843783907624317274796926248829543413464754127208843070331063037</span><br><span class="line">381631268825806469518166370387352035475775677163615730759454343913563615970881967332407709901235637718936184198930226303761876517101208677107311006065728014220477966000620964056616058676999878976943319063836649085085377577273214792371548775204594097887078898598463892440141577974544939268247818937936607013100808169758675042264568547764031628431414727922168580998494695800403043312406643527637667466318473669542326169218665366423043579003388486634167642663495896607282155808331902351188500197960905672207046579647052764579411814305689137519860880916467272056778641442758940135016400808740387144508156358067955215018</span><br><span class="line">979153370552535153498477459720877329811204688208387543826122582132404214848454954722487086658061408795223805022202997613522014736983452121073860054851302343517756732701026667062765906277626879215457936330799698812755973057557620930172778859116538571207100424990838508255127616637334499680058645411786925302368790414768248611809358160197554369255458675450109457987698749584630551177577492043403656419968285163536823819817573531356497236154342689914525321673807925458651854768512396355389740863270148775362744448115581639629326362342160548500035000156097215446881251055505465713854173913142040976382500435185442521721  12806210903061368369054309575159360374022344774547459345216907128193957592938071815865954073287532545947370671838372144806539753829484356064919357285623305209600680570975224639214396805124350862772159272362778768036844634760917612708721787320159318432456050806227784435091161119982613987303255995543165395426658059462110056431392517548717447898084915167661172362984251201688639469652283452307712821398857016487590794996544468826705600332208535201443322267298747117528882985955375246424812616478327182399461709978893464093245135530135430007842223389360212803439850867615121148050034887767584693608776323252233254261047</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>从题目附件的task,py提取所需数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line">c1 = 12641635617803746150332232646354596292707861480200207537199141183624438303757120570096741248020236666965755798009656547738616399025300123043766255518596149348930444599820675230046423373053051631932557230849083426859490183732303751744004874183062594856870318614289991675980063548316499486908923209627563871554875612702079100567018698992935818206109087568166097392314105717555482926141030505639571708876213167112187962584484065321545727594135175369233925922507794999607323536976824183162923385005669930403448853465141405846835919842908469787547341752365471892495204307644586161393228776042015534147913888338316244169120</span><br><span class="line">n1 = 13508774104460209743306714034546704137247627344981133461801953479736017021401725818808462898375994767375627749494839671944543822403059978073813122441407612530658168942987820256786583006947001711749230193542370570950705530167921702835627122401475251039000775017381633900222474727396823708695063136246115652622259769634591309421761269548260984426148824641285010730983215377509255011298737827621611158032976420011662547854515610597955628898073569684158225678333474543920326532893446849808112837476684390030976472053905069855522297850688026960701186543428139843783907624317274796926248829543413464754127208843070331063037</span><br><span class="line">c2 = 97915337055253515349847745972087732981120468820838754382612258213240421484845495472248708665806140879522380502220299761352201473698345</span><br><span class="line">n2 = 12806210903061368369054309575159360374022344774547459345216907128193957592938071815865954073287532545947370671838372144806539753829484356064919357285623305209600680570975224639214396805124350862772159272362778768036844634760917612708721787320159318432456050806227784435091161119982613987303255995543165395426658059462110056431392517548717447898084915167661172362984251201688639469652283452307712821398857016487590794996544468826705600332208535201443322267298747117528882985955375246424812616478327182399461709978893464093245135530135430007842223389360212803439850867615121148050034887767584693608776323252233254261047</span><br><span class="line">e = 52361</span><br><span class="line">p = gmpy2.gcd(n1, n2)</span><br><span class="line">q = n1 // p</span><br><span class="line">phi = (p - 1) * (q - 1)</span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line"></span><br><span class="line">flag = pow(c1, d, n1)</span><br><span class="line"></span><br><span class="line">print(bytes.fromhex(hex(flag)[2:]))</span><br></pre></td></tr></table></figure>

<p>最终flag为<code>BJD&#123;p_is_common_divisor&#125;</code></p>
<h6 id="爆破e"><a href="#爆破e" class="headerlink" title="爆破e"></a>爆破e</h6><p>当然e如果没有提示呢，e小于100000，又有<code>pow(294,e,n)</code>，可以通过爆破e的取值很快得到e,代码如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">output=381631268825806469518166370387352035475775677163615730759454343913563615970881967332407709901235637718936184198930226303761876517101208677107311006065728014220477966000620964056616058676999878976943319063836649085085377577273214792371548775204594097887078898598463892440141577974544939268247818937936607013100808169758675042264568547764031628431414727922168580998494695800403043312406643527637667466318473669542326169218665366423043579003388486634167642663495896607282155808331902351188500197960905672207046579647052764579411814305689137519860880916467272056778641442758940135016400808740387144508156358067955215018</span><br><span class="line">for i in range(100000):</span><br><span class="line">    res=pow(294,i,n1)</span><br><span class="line">    if (res==output):</span><br><span class="line">        print(i)</span><br><span class="line">        e=i</span><br><span class="line">        break</span><br></pre></td></tr></table></figure>

<p>一般脚本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line">c1 = </span><br><span class="line">n1 = </span><br><span class="line">c2 = </span><br><span class="line">n2 = </span><br><span class="line">e = 65537</span><br><span class="line">p = gmpy2.gcd(n1, n2)</span><br><span class="line">q = n1 // p</span><br><span class="line">phi = (p - 1) * (q - 1)</span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line"></span><br><span class="line">flag = pow(c1, d, n1)</span><br><span class="line"></span><br><span class="line">print(bytes.fromhex(hex(flag)[2:]))</span><br></pre></td></tr></table></figure>

<h5 id="共模攻击"><a href="#共模攻击" class="headerlink" title="共模攻击"></a>共模攻击</h5><p>rsa modulo-related attacks</p>
<p>如果使用了相同的模 n 对相同的明文 m 进行了加密，我们就可以在不分解 n 的情况下还原出明文 m 的值。即<br> c1 &#x3D; m^e1 mod n<br> c2 &#x3D; m^e2 mod n<br>此时不需要分解n，也不需要求解私钥，如果e1和e2互素，那么就可以利用共模攻击利用两个密文和公钥给出的情况下还原密文m</p>
<p>简单的过程，前提条件两个加密指数互质<br> gcd(e1,e2) &#x3D; 1，那么s2存在，则：<br> s1 * e1 + s2 * e2 &#x3D; 1<br> 因为c1 &#x3D; m^e1 mod n，c2 &#x3D; m^e2 mod n<br> 代入化简可以得出 c1^s2 * c2^s2 ≡ m mod n</p>
<blockquote>
<p>eg：2020-BJDCTF-Crypto-rsa_output</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;21058339337354287847534107544613605305015441090508924094198816691219103399526800112802416383088995253908857460266726925615826895303377801614829364034624475195859997943146305588315939130777450485196290766249612340054354622516207681542973756257677388091926549655162490873849955783768663029138647079874278240867932127196686258800146911620730706734103611833179733264096475286491988063990431085380499075005629807702406676707841324660971173253100956362528346684752959937473852630145893796056675793646430793578265418255919376323796044588559726703858429311784705245069845938316802681575653653770883615525735690306674635167111,2767&#125;</span><br><span class="line"></span><br><span class="line">&#123;21058339337354287847534107544613605305015441090508924094198816691219103399526800112802416383088995253908857460266726925615826895303377801614829364034624475195859997943146305588315939130777450485196290766249612340054354622516207681542973756257677388091926549655162490873849955783768663029138647079874278240867932127196686258800146911620730706734103611833179733264096475286491988063990431085380499075005629807702406676707841324660971173253100956362528346684752959937473852630145893796056675793646430793578265418255919376323796044588559726703858429311784705245069845938316802681575653653770883615525735690306674635167111,3659&#125;</span><br><span class="line"></span><br><span class="line">message1=20152490165522401747723193966902181151098731763998057421967155300933719378216342043730801302534978403741086887969040721959533190058342762057359432663717825826365444996915469039056428416166173920958243044831404924113442512617599426876141184212121677500371236937127571802891321706587610393639446868836987170301813018218408886968263882123084155607494076330256934285171370758586535415136162861138898728910585138378884530819857478609791126971308624318454905992919405355751492789110009313138417265126117273710813843923143381276204802515910527468883224274829962479636527422350190210717694762908096944600267033351813929448599</span><br><span class="line"></span><br><span class="line">message2=11298697323140988812057735324285908480504721454145796535014418738959035245600679947297874517818928181509081545027056523790022598233918011261011973196386395689371526774785582326121959186195586069851592467637819366624044133661016373360885158956955263645614345881350494012328275215821306955212788282617812686548883151066866149060363482958708364726982908798340182288702101023393839781427386537230459436512613047311585875068008210818996941460156589314135010438362447522428206884944952639826677247819066812706835773107059567082822312300721049827013660418610265189288840247186598145741724084351633508492707755206886202876227</span><br></pre></td></tr></table></figure>

<p>key：观察第一个和第二个的n一样, 不同的是e, 可判断是共模攻击</p>
<p>根据题目给出的文件，提取所需参数，写出decrypt脚本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">import  gmpy2</span><br><span class="line">import  binascii</span><br><span class="line">import  rsa</span><br><span class="line">import math</span><br><span class="line">def exgcd(m, n, x, y):</span><br><span class="line">    if n == 0:</span><br><span class="line">        x = 1</span><br><span class="line">        y = 0</span><br><span class="line">        return (m, x, y)</span><br><span class="line">    a1 = b = 1</span><br><span class="line">    a = b1 = 0</span><br><span class="line">    c = m</span><br><span class="line">    d = n</span><br><span class="line">    q = int(c / d)</span><br><span class="line">    r = c % d</span><br><span class="line">    while r:</span><br><span class="line">        c = d</span><br><span class="line">        d = r</span><br><span class="line">        t = a1</span><br><span class="line">        a1 = a</span><br><span class="line">        a = t - q * a</span><br><span class="line">        t = b1</span><br><span class="line">        b1 = b</span><br><span class="line">        b = t - q * b</span><br><span class="line">        q = int(c / d)</span><br><span class="line">        r = c % d</span><br><span class="line">    x = a</span><br><span class="line">    y = b</span><br><span class="line">    return (d, x, y)#扩展欧几里得算法</span><br><span class="line">c1=20152490165522401747723193966902181151098731763998057421967155300933719378216342043730801302534978403741086887969040721959533190058342762057359432663717825826365444996915469039056428416166173920958243044831404924113442512617599426876141184212121677500371236937127571802891321706587610393639446868836987170301813018218408886968263882123084155607494076330256934285171370758586535415136162861138898728910585138378884530819857478609791126971308624318454905992919405355751492789110009313138417265126117273710813843923143381276204802515910527468883224274829962479636527422350190210717694762908096944600267033351813929448599</span><br><span class="line">c2=11298697323140988812057735324285908480504721454145796535014418738959035245600679947297874517818928181509081545027056523790022598233918011261011973196386395689371526774785582326121959186195586069851592467637819366624044133661016373360885158956955263645614345881350494012328275215821306955212788282617812686548883151066866149060363482958708364726982908798340182288702101023393839781427386537230459436512613047311585875068008210818996941460156589314135010438362447522428206884944952639826677247819066812706835773107059567082822312300721049827013660418610265189288840247186598145741724084351633508492707755206886202876227</span><br><span class="line">e1=2767</span><br><span class="line">e2=3659</span><br><span class="line">n=21058339337354287847534107544613605305015441090508924094198816691219103399526800112802416383088995253908857460266726925615826895303377801614829364034624475195859997943146305588315939130777450485196290766249612340054354622516207681542973756257677388091926549655162490873849955783768663029138647079874278240867932127196686258800146911620730706734103611833179733264096475286491988063990431085380499075005629807702406676707841324660971173253100956362528346684752959937473852630145893796056675793646430793578265418255919376323796044588559726703858429311784705245069845938316802681575653653770883615525735690306674635167111</span><br><span class="line"></span><br><span class="line">ans=exgcd(e1,e2,0,0)</span><br><span class="line">s1=ans[1]</span><br><span class="line">s2=ans[2]</span><br><span class="line">m=(gmpy2.powmod(c1,s1,n)*gmpy2.powmod(c2,s2,n))%n</span><br><span class="line">#powmod()函数真香,分数取模也可直接算,一开始不知道还去找了很多的算法知识</span><br><span class="line">print(binascii.unhexlify(hex(m)[2:]))</span><br><span class="line"></span><br><span class="line">#BJD&#123;r3a_C0mmoN_moD@_4ttack&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>powmod()函数</p>
</blockquote>
<h5 id="考数学b（￣▽￣）d"><a href="#考数学b（￣▽￣）d" class="headerlink" title="考数学b（￣▽￣）d"></a>考数学b（￣▽￣）d</h5><blockquote>
<p>2020-BJDCTF-Crypto-EasyRSA</p>
</blockquote>
<p>key：Derivative()和Fraction()的作用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import getPrime,bytes_to_long</span><br><span class="line">from sympy import Derivative</span><br><span class="line">from fractions import Fraction</span><br><span class="line">from secret import flag</span><br><span class="line"></span><br><span class="line">p=getPrime(1024)</span><br><span class="line">q=getPrime(1024)</span><br><span class="line">e=65537</span><br><span class="line">n=p*q</span><br><span class="line">z=Fraction(1,Derivative(arctan(p),p))-Fraction(1,Derivative(arth(q),q))</span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line">c=pow(m,e,n)</span><br><span class="line">print(c,z,n)</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">output:</span><br><span class="line">7922547866857761459807491502654216283012776177789511549350672958101810281348402284098310147796549430689253803510994877420135537268549410652654479620858691324110367182025648788407041599943091386227543182157746202947099572389676084392706406084307657000104665696654409155006313203957292885743791715198781974205578654792123191584957665293208390453748369182333152809882312453359706147808198922916762773721726681588977103877454119043744889164529383188077499194932909643918696646876907327364751380953182517883134591810800848971719184808713694342985458103006676013451912221080252735948993692674899399826084848622145815461035</span><br><span class="line">32115748677623209667471622872185275070257924766015020072805267359839059393284316595882933372289732127274076434587519333300142473010344694803885168557548801202495933226215437763329280242113556524498457559562872900811602056944423967403777623306961880757613246328729616643032628964072931272085866928045973799374711846825157781056965164178505232524245809179235607571567174228822561697888645968559343608375331988097157145264357626738141646556353500994924115875748198318036296898604097000938272195903056733565880150540275369239637793975923329598716003350308259321436752579291000355560431542229699759955141152914708362494482</span><br><span class="line">15310745161336895413406690009324766200789179248896951942047235448901612351128459309145825547569298479821101249094161867207686537607047447968708758990950136380924747359052570549594098569970632854351825950729752563502284849263730127586382522703959893392329333760927637353052250274195821469023401443841395096410231843592101426591882573405934188675124326997277775238287928403743324297705151732524641213516306585297722190780088180705070359469719869343939106529204798285957516860774384001892777525916167743272419958572055332232056095979448155082465977781482598371994798871917514767508394730447974770329967681767625495394441</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Derivative是表示导函数的类，它的第一个参数是需要进行求导的数学函数，第二个参数是求导的自变量，注意：Derivative所得到的是一个导函数，它不会进行求导运算；例：t&#x3D;Derivative(sin(x),x)</p>
<p>Fraction()也很简单，就是进行分数运算，例：Fraction(2,8)等于0.25</p>
<p>然后对对arctan(x)和arth(x)求导</p>
<p>由此对加密脚本中的z化简得到：p^2 + q^2</p>
<p>decrypt</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: UTF-8 -*-</span><br><span class="line">from gmpy2 import *</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">import sympy</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">e=65537</span><br><span class="line">c = 7922547866857761459807491502654216283012776177789511549350672958101810281348402284098310147796549430689253803510994877420135537268549410652654479620858691324110367182025648788407041599943091386227543182157746202947099572389676084392706406084307657000104665696654409155006313203957292885743791715198781974205578654792123191584957665293208390453748369182333152809882312453359706147808198922916762773721726681588977103877454119043744889164529383188077499194932909643918696646876907327364751380953182517883134591810800848971719184808713694342985458103006676013451912221080252735948993692674899399826084848622145815461035</span><br><span class="line">z = 32115748677623209667471622872185275070257924766015020072805267359839059393284316595882933372289732127274076434587519333300142473010344694803885168557548801202495933226215437763329280242113556524498457559562872900811602056944423967403777623306961880757613246328729616643032628964072931272085866928045973799374711846825157781056965164178505232524245809179235607571567174228822561697888645968559343608375331988097157145264357626738141646556353500994924115875748198318036296898604097000938272195903056733565880150540275369239637793975923329598716003350308259321436752579291000355560431542229699759955141152914708362494482</span><br><span class="line">n = 15310745161336895413406690009324766200789179248896951942047235448901612351128459309145825547569298479821101249094161867207686537607047447968708758990950136380924747359052570549594098569970632854351825950729752563502284849263730127586382522703959893392329333760927637353052250274195821469023401443841395096410231843592101426591882573405934188675124326997277775238287928403743324297705151732524641213516306585297722190780088180705070359469719869343939106529204798285957516860774384001892777525916167743272419958572055332232056095979448155082465977781482598371994798871917514767508394730447974770329967681767625495394441</span><br><span class="line">s = time.clock()#  time.perf_counter</span><br><span class="line"></span><br><span class="line">p = sympy.Symbol(&#x27;p&#x27;)#方程组定义变量</span><br><span class="line">q = sympy.Symbol(&#x27;q&#x27;)</span><br><span class="line">f1 = p**2+q**2-z</span><br><span class="line">f2 = p*q-n</span><br><span class="line">result = sympy.solve([f1,f2],[p,q])</span><br><span class="line">#print result</span><br><span class="line">p = int(result[2][0])</span><br><span class="line">q = int(result[2][1])</span><br><span class="line"></span><br><span class="line">phi = (p-1)*(q-1)</span><br><span class="line">d = invert(e,phi)</span><br><span class="line">m = pow(c,d,p*q)</span><br><span class="line">print long_to_bytes(m)</span><br><span class="line">print &#x27;[!]Timer:&#x27;, round(time.clock() - s, 2)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>出现错误 ：      AttributeError module ‘time’ has no attribute ‘clock’</p>
<p>原因        ：       Python time.clock在Python3.3废弃，在Python3.8中将被移除,  而我用的python3.10</p>
<p>解决方法 ：       使用perf_counter()方法</p>
</blockquote>
<p>tip：python使用过程中因版本问题而踩的一些坑， 所以，面对报错要冷静，先多看看，再去乱改👋</p>
<p>以上是RSA简单入门，当然常见类型还有低加密指数攻击，低解密指数攻，Coppersmith 相关攻击，侧信道，选择明密文攻击等等。后续文章会逐步补充并且会再多整理几道CTF出现过的例题,还有一些常见类型的变形，比如RSA共模 e1，e2不互素怎么办，后续会介绍。</p>
<h2 id="滴答滴答"><a href="#滴答滴答" class="headerlink" title="滴答滴答"></a>滴答滴答</h2><p>三⭐  </p>
<p>音频图形式的莫斯码</p>
<p>key：细.   粗-   空&#x2F;</p>
<blockquote>
<p>.-&#x2F;.-..&#x2F;.–.&#x2F;….&#x2F;.-&#x2F;.-..&#x2F;.-&#x2F;-…</p>
</blockquote>
<img src="/2022/06/26/ctfhub/6.png" class>

<h2 id="编码与调制"><a href="#编码与调制" class="headerlink" title="编码与调制"></a>编码与调制</h2><p>四⭐	BJDCTF</p>
<p>key：曼彻斯特编码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">密文：2559659965656A9A65656996696965A6695669A9695A699569666A5A6A6569666A59695A69AA696569666AA6</span><br></pre></td></tr></table></figure>

<p>I’m hint！！！</p>
<img src="/2022/06/26/ctfhub/7.png" class>

<p>（这是个什么图哦(⊙o⊙)？😭</p>
<p>从图中的Manchester可以看出这是一个曼彻斯特编码</p>
<p>tip：Manchester Encoding，也叫做相位编码（ Phase Encode，简写PE），是一个同步时钟编码技术，被物理层使用来编码一个同步位流的时钟和数据。</p>
<p>曼彻斯特解码操作按照1-2-3的顺序</p>
<img src="/2022/06/26/ctfhub/8.png" class>

<p>024A447B4469664D616E63686573746572636F64657D</p>
<p>hex转字符串：</p>
<p>BJD{DifManchestercode}</p>
<h2 id="rand"><a href="#rand" class="headerlink" title="rand"></a>rand</h2><p>八⭐  网鼎白虎</p>
<p>key：MT19937预测key</p>
<p>看的脑壳疼，下次一定</p>
<p><a target="_blank" rel="noopener" href="https://www.wolai.com/ctfhub/uDCoGsHmHe8SfLoTMwQ5SU">rand (wolai.com)</a></p>
<h2 id="boom"><a href="#boom" class="headerlink" title="boom"></a>boom</h2><p>三⭐ 网鼎</p>
<p>连续三次解密后，程序报错退出</p>
<p>（没错，都可以用网站解。。。）</p>
<p>本着能不动脑，就不动脑，能不动手就不动手的principal</p>
<p>？？？这时怎么知道flag</p>
<p>题目给的是boom.exe</p>
<p>key：先把程序扔进IDA</p>
<img src="/2022/06/26/ctfhub/9.png" class>

<blockquote>
<p>flag{en5oy_746831_89127561}</p>
</blockquote>
<h2 id="Not-only-base"><a href="#Not-only-base" class="headerlink" title="Not_only_base"></a>Not_only_base</h2><p>三⭐ 网鼎</p>
<p>key：火眼金睛</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c：MCJIJSGKP=ZZYXZXRMU=W3YZG3ZZ==G3HQHCUS==</span><br></pre></td></tr></table></figure>

<p>可以看出是被打乱的base32</p>
<p>栅栏解密，看出组数为4  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MZWGCZ33JYYHIXZQJZGHSX3CGRZUKMZSPU======</span><br></pre></td></tr></table></figure>

<h2 id="base？？"><a href="#base？？" class="headerlink" title="base？？"></a>base？？</h2><p>四⭐ BJDCTF</p>
<p>key：替换字典集</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">dict:&#123;0: &#x27;J&#x27;, 1: &#x27;K&#x27;, 2: &#x27;L&#x27;, 3: &#x27;M&#x27;, 4: &#x27;N&#x27;, 5: &#x27;O&#x27;, 6: &#x27;x&#x27;, 7: &#x27;y&#x27;, 8: &#x27;U&#x27;, 9: &#x27;V&#x27;, 10: &#x27;z&#x27;, 11: &#x27;A&#x27;, 12: &#x27;B&#x27;, 13: &#x27;C&#x27;, 14: &#x27;D&#x27;, 15: &#x27;E&#x27;, 16: &#x27;F&#x27;, 17: &#x27;G&#x27;, 18: &#x27;H&#x27;, 19: &#x27;7&#x27;, 20: &#x27;8&#x27;, 21: &#x27;9&#x27;, 22: &#x27;P&#x27;, 23: &#x27;Q&#x27;, 24: &#x27;I&#x27;, 25: &#x27;a&#x27;, 26: &#x27;b&#x27;, 27: &#x27;c&#x27;, 28: &#x27;d&#x27;, 29: &#x27;e&#x27;, 30: &#x27;f&#x27;, 31: &#x27;g&#x27;, 32: &#x27;h&#x27;, 33: &#x27;i&#x27;, 34: &#x27;j&#x27;, 35: &#x27;k&#x27;, 36: &#x27;l&#x27;, 37: &#x27;m&#x27;, 38: &#x27;W&#x27;, 39: &#x27;X&#x27;, 40: &#x27;Y&#x27;, 41: &#x27;Z&#x27;, 42: &#x27;0&#x27;, 43: &#x27;1&#x27;, 44: &#x27;2&#x27;, 45: &#x27;3&#x27;, 46: &#x27;4&#x27;, 47: &#x27;5&#x27;, 48: &#x27;6&#x27;, 49: &#x27;R&#x27;, 50: &#x27;S&#x27;, 51: &#x27;T&#x27;, 52: &#x27;n&#x27;, 53: &#x27;o&#x27;, 54: &#x27;p&#x27;, 55: &#x27;q&#x27;, 56: &#x27;r&#x27;, 57: &#x27;s&#x27;, 58: &#x27;t&#x27;, 59: &#x27;u&#x27;, 60: &#x27;v&#x27;, 61: &#x27;w&#x27;, 62: &#x27;+&#x27;, 63: &#x27;/&#x27;, 64: &#x27;=&#x27;&#125;</span><br><span class="line"></span><br><span class="line">chipertext:</span><br><span class="line">FlZNfnF6Qol6e9w17WwQQoGYBQCgIkGTa9w3IQKw</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>？？？</p>
<p><img src="https://img-blog.csdnimg.cn/20200319220730248.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDAxNzgzOA==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line">dict=&#123;0: &#x27;J&#x27;, 1: &#x27;K&#x27;, 2: &#x27;L&#x27;, 3: &#x27;M&#x27;, 4: &#x27;N&#x27;, 5: &#x27;O&#x27;, 6: &#x27;x&#x27;, 7: &#x27;y&#x27;, 8: &#x27;U&#x27;, 9: &#x27;V&#x27;, 10: &#x27;z&#x27;, 11: &#x27;A&#x27;, 12: &#x27;B&#x27;, 13: &#x27;C&#x27;, 14: &#x27;D&#x27;, 15: &#x27;E&#x27;, 16: &#x27;F&#x27;, 17: &#x27;G&#x27;, 18: &#x27;H&#x27;, 19: &#x27;7&#x27;, 20: &#x27;8&#x27;, 21: &#x27;9&#x27;, 22: &#x27;P&#x27;, 23: &#x27;Q&#x27;, 24: &#x27;I&#x27;, 25: &#x27;a&#x27;, 26: &#x27;b&#x27;, 27: &#x27;c&#x27;, 28: &#x27;d&#x27;, 29: &#x27;e&#x27;, 30: &#x27;f&#x27;, 31: &#x27;g&#x27;, 32: &#x27;h&#x27;,33: &#x27;i&#x27;, 34: &#x27;j&#x27;, 35: &#x27;k&#x27;, 36: &#x27;l&#x27;, 37: &#x27;m&#x27;, 38: &#x27;W&#x27;, 39: &#x27;X&#x27;, 40: &#x27;Y&#x27;, 41: &#x27;Z&#x27;, 42: &#x27;0&#x27;, 43: &#x27;1&#x27;, 44: &#x27;2&#x27;, 45: &#x27;3&#x27;, 46: &#x27;4&#x27;, 47: &#x27;5&#x27;, 48: &#x27;6&#x27;, 49: &#x27;R&#x27;, 50: &#x27;S&#x27;, 51: &#x27;T&#x27;, 52: &#x27;n&#x27;, 53: &#x27;o&#x27;, 54: &#x27;p&#x27;, 55: &#x27;q&#x27;, 56: &#x27;r&#x27;, 57: &#x27;s&#x27;, 58: &#x27;t&#x27;, 59: &#x27;u&#x27;, 60: &#x27;v&#x27;, 61: &#x27;w&#x27;, 62: &#x27;+&#x27;, 63: &#x27;/&#x27;, 64: &#x27;=&#x27;&#125;</span><br><span class="line">base64_list = [&#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;, &#x27;D&#x27;, &#x27;E&#x27;, &#x27;F&#x27;, &#x27;G&#x27;, &#x27;H&#x27;, &#x27;I&#x27;, &#x27;J&#x27;, &#x27;K&#x27;, &#x27;L&#x27;, &#x27;M&#x27;, &#x27;N&#x27;, &#x27;O&#x27;, &#x27;P&#x27;,&#x27;Q&#x27;, &#x27;R&#x27;, &#x27;S&#x27;, &#x27;T&#x27;, &#x27;U&#x27;, &#x27;V&#x27;, &#x27;W&#x27;, &#x27;X&#x27;, &#x27;Y&#x27;, &#x27;Z&#x27;, &#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;, &#x27;d&#x27;, &#x27;e&#x27;, &#x27;f&#x27;,&#x27;g&#x27;, &#x27;h&#x27;, &#x27;i&#x27;, &#x27;j&#x27;, &#x27;k&#x27;, &#x27;l&#x27;, &#x27;m&#x27;, &#x27;n&#x27;, &#x27;o&#x27;, &#x27;p&#x27;, &#x27;q&#x27;, &#x27;r&#x27;, &#x27;s&#x27;, &#x27;t&#x27;, &#x27;u&#x27;, &#x27;v&#x27;,&#x27;w&#x27;, &#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;, &#x27;0&#x27;, &#x27;1&#x27;, &#x27;2&#x27;, &#x27;3&#x27;, &#x27;4&#x27;, &#x27;5&#x27;, &#x27;6&#x27;, &#x27;7&#x27;, &#x27;8&#x27;, &#x27;9&#x27;, &#x27;+&#x27;, &#x27;/&#x27;]</span><br><span class="line">cipher=&#x27;FlZNfnF6Qol6e9w17WwQQoGYBQCgIkGTa9w3IQKw&#x27;</span><br><span class="line">res=&#x27;&#x27;</span><br><span class="line">for i in range(len(cipher)):</span><br><span class="line">    for j in range(64):</span><br><span class="line">        if(dict[j]==cipher[i]):</span><br><span class="line">            res+=base64_list[j]</span><br><span class="line">print(res)</span><br><span class="line">flag=base64.b64decode(res)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<h2 id="Quick-Math"><a href="#Quick-Math" class="headerlink" title="Quick Math"></a>Quick Math</h2><p>四⭐  CSICTF</p>
<p>key：低加密指数广播攻击 RSA Johan Hastad attack </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ben has encrypted a message with the same value of &#x27;e&#x27; for 3 public moduli - n1 = 86812553978993 n2 = 81744303091421 n3 = 83695120256591 and got the cipher texts - c1 = 8875674977048 c2 = 70744354709710 c3 = 29146719498409. Find the original message. (Wrap it with csictf&#123;&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">from pwn import remote</span><br><span class="line">from sympy.ntheory.modular import crt</span><br><span class="line">from gmpy2 import iroot</span><br><span class="line">e = 3</span><br><span class="line">N = [86812553978993, 81744303091421, 83695120256591]</span><br><span class="line">C = [8875674977048, 70744354709710, 29146719498409]</span><br><span class="line">resultant, mod = crt(N,C)</span><br><span class="line">value, is_perfect = iroot(resultant,e)</span><br><span class="line">print(bytes.fromhex(str(value)).decode())</span><br></pre></td></tr></table></figure>

<h2 id="track-hacker"><a href="#track-hacker" class="headerlink" title="track_hacker"></a>track_hacker</h2><p>四⭐   网鼎</p>
<p>shell.pcap流量包，好吧，要用WireShark（我还不会用😭）</p>
<p>学！</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/lsdb/p/9254544.html">Wireshark使用教程（界面说明、捕获过滤器表达式、显示过滤器表达式） - 诸子流 - 博客园 (cnblogs.com)</a></p>
<p>搜索flag</p>
<p>追踪TPC流</p>
<p>得到一串base64编码，但是！无法直接用网站解码</p>
<img src="/2022/06/26/ctfhub/10.png" class>

<p>python脚本</p>
<p>Python3 中有一些区别，因为 Python3 中字符都是 unicode 编码，而 <code>b64encode</code> 函数的参数为 byte 类型，所以必须先转码。</p>
<p>参考：</p>
<p><a target="_blank" rel="noopener" href="https://www.o2oxy.cn/1753.html">网鼎杯第三场wp - print(“”) (o2oxy.cn)</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">还在想为什么。。。。</span><br></pre></td></tr></table></figure>

<h2 id="Rivest-Shamir-Adleman"><a href="#Rivest-Shamir-Adleman" class="headerlink" title="Rivest Shamir Adleman"></a>Rivest Shamir Adleman</h2><p>四⭐   CSICTF</p>
<p>key：新的脚本已出现</p>
<p>enc.txt</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">n=408579146706567976063586763758203051093687666875502812646277701560732347095463873824829467529879836457478436098685606552992513164224712398195503564207485938278827523972139196070431397049700119503436522251010430918143933255323117421712000644324381094600257291929523792609421325002527067471808992410166917641057703562860663026873111322556414272297111644069436801401012920448661637616392792337964865050210799542881102709109912849797010633838067759525247734892916438373776477679080154595973530904808231</span><br><span class="line">e=65537</span><br><span class="line">c=226582271940094442087193050781730854272200420106419489092394544365159707306164351084355362938310978502945875712496307487367548451311593283589317511213656234433015906518135430048027246548193062845961541375898496150123721180020417232872212026782286711541777491477220762823620612241593367070405349675337889270277102235298455763273194540359004938828819546420083966793260159983751717798236019327334525608143172073795095665271013295322241504491351162010517033995871502259721412160906176911277416194406909</span><br></pre></td></tr></table></figure>

<p>python</p>
<blockquote>
<p>The values of is generated using a small prime. One of the primes can be searched using brute-force and the message can then be decrypted.</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import mod</span><br><span class="line">f = open(&quot;enc.txt&quot;).read().split(&#x27;\n&#x27;)</span><br><span class="line">#不用再复制粘贴n、e、c了</span><br><span class="line">n = int(f[0].split()[2])</span><br><span class="line">e = int(f[1].split()[2])</span><br><span class="line">c = int(f[2].split()[2])</span><br><span class="line">p = None</span><br><span class="line">#暴力搜索</span><br><span class="line">for i in range(2,n):</span><br><span class="line">  if n % i == 0:</span><br><span class="line">    p = i</span><br><span class="line">    break</span><br><span class="line">#找到小p，再得到大q</span><br><span class="line">q = n // p</span><br><span class="line">#得d</span><br><span class="line">phi = (p-1) * (q-1)    </span><br><span class="line">em = mod.Mod(e, phi)</span><br><span class="line">d = int(1 // em)</span><br><span class="line">cm = mod.Mod(c, n)</span><br><span class="line">dec = int(cm ** d)</span><br><span class="line">print(bytes.fromhex(hex(dec)[2:]))</span><br></pre></td></tr></table></figure>

<h2 id="rosb"><a href="#rosb" class="headerlink" title="rosb"></a>rosb</h2><p>四⭐     空间智能安全</p>
<p>key: RSA共模攻击</p>
<p>rosb.py</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">from flag import flag</span><br><span class="line">from Crypto.Util.number import long_to_bytes,bytes_to_long,getPrime</span><br><span class="line">from os import urandom</span><br><span class="line"></span><br><span class="line">#返回n,e,p,q</span><br><span class="line">def gen_arg():</span><br><span class="line">    p=getPrime(1024)</span><br><span class="line">    q=getPrime(1024)</span><br><span class="line">    open(&quot;log.txt&quot;,&quot;w&quot;).write(hex(p)+&quot;\n&quot;+hex(q))</span><br><span class="line">    n=p*q</span><br><span class="line">    e=getPrime(32)</span><br><span class="line">    return n,e,p,q</span><br><span class="line"></span><br><span class="line">#密文前四个字符为‘rose’</span><br><span class="line">def mamacheck(c):</span><br><span class="line">    if long_to_bytes(c)[0:4]!=&quot;rose&quot;:</span><br><span class="line">        return False</span><br><span class="line">    return True</span><br><span class="line"></span><br><span class="line">def babasay(m):</span><br><span class="line">    n,e,p,q=gen_arg()</span><br><span class="line">    c=pow(m,e,n)</span><br><span class="line">    print hex(n)</span><br><span class="line">    print hex(e)</span><br><span class="line">    print hex(c)</span><br><span class="line">#找到满足条件的e</span><br><span class="line">    if not mamacheck(c):</span><br><span class="line">        e=getPrime(32)</span><br><span class="line">    c = pow(m, e, n)</span><br><span class="line">    print hex(e)</span><br><span class="line">    print hex(c)</span><br><span class="line"></span><br><span class="line">#明文是flag+随机产生64个字节的字符</span><br><span class="line">m=bytes_to_long(flag+urandom(64))</span><br><span class="line">babasay(m)</span><br><span class="line"></span><br><span class="line">#输出n、e、c，e2、c2</span><br><span class="line">&#x27;&#x27;&#x27;otuput:</span><br><span class="line">0xa1d4d377001f1b8d5b2740514ce699b49dc8a02f12df9a960e80e2a6ee13b7a97d9f508721e3dd7a6842c24ab25ab87d1132358de7c6c4cee3fb3ec9b7fd873626bd0251d16912de1f0f1a2bba52b082339113ad1a262121db31db9ee1bf9f26023182acce8f84612bfeb075803cf610f27b7b16147f7d29cc3fd463df7ea31ca860d59aae5506479c76206603de54044e7b778e21082c4c4da795d39dc2b9c0589e577a773133c89fa8e3a4bd047b8e7d6da0d9a0d8a3c1a3607ce983deb350e1c649725cccb0e9d756fc3107dd4352aa18c45a65bab7772a4c5aef7020a1e67e6085cc125d9fc042d96489a08d885f448ece8f7f254067dfff0c4e72a63557L</span><br><span class="line">0xf4c1158fL</span><br><span class="line">0x2f6546062ff19fe6a3155d76ef90410a3cbc07fef5dff8d3d5964174dfcaf9daa003967a29c516657044e87c1cbbf2dba2e158452ca8b7adba5e635915d2925ac4f76312feb3b0c85c3b8722c0e4aedeaec2f2037cc5f676f99b7260c3f83ffbaba86cda0f6a9cd4c70b37296e8f36c3ceaae15b5bf0b290119592ff03427b80055f08c394e5aa6c45bd634c80c59a9f70a92dc70eebec15d4a5e256bf78775e0d3d14f3a0103d9ad8ea6257a0384091f14da59e52581ba2e8ad3adb9747435e9283e8064de21ac41ab2c7b161a3c072b7841d4a594a8b348a923d4cc39f02e05ce95a69c7500c29f6bb415c11e4e0cdb410d0ec2644d6243db38e893c8a3707L</span><br><span class="line">0xf493f7d1L</span><br><span class="line">0xd32dfad68d790022758d155f2d8bf46bb762ae5cc17281f2f3a8794575ec684819690b22106c1cdaea06abaf7d0dbf841ebd152be51528338d1da8a78f666e0da85367ee8c1e6addbf590fc15f1b2182972dcbe4bbe8ad359b7d15febd5597f5a87fa4c6c51ac4021af60aeb726a3dc7689daed70144db57d1913a4dc29a2b2ec34c99c507d0856d6bf5d5d01ee514d47c7477a7fb8a6747337e7caf2d6537183c20e14c7b79380d9f7bcd7cda9e3bfb00c2b57822663c9a5a24927bceec316c8ffc59ab3bfc19f364033da038a4fb3ecef3b4cb299f4b600f76b8a518b25b576f745412fe53d229e77e68380397eee6ffbc36f6cc734815cd4065dc73dcbcbL</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure>

<p>构造脚本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2 as gp</span><br><span class="line"></span><br><span class="line">def exgcd(a, b):</span><br><span class="line">    if b==0:</span><br><span class="line">        return 1, 0, a</span><br><span class="line">    x2, y2, r = exgcd(b, a%b)</span><br><span class="line">    x1 = y2</span><br><span class="line">    y1 = x2-(a//b)*y2</span><br><span class="line">    return x1, y1, r</span><br><span class="line">c1=gp.mpz(0x2f6546062ff19fe6a3155d76ef90410a3cbc07fef5dff8d3d5964174dfcaf9daa003967a29c516657044e87c1cbbf2dba2e158452ca8b7adba5e635915d2925ac4f76312feb3b0c85c3b8722c0e4aedeaec2f2037cc5f676f99b7260c3f83ffbaba86cda0f6a9cd4c70b37296e8f36c3ceaae15b5bf0b290119592ff03427b80055f08c394e5aa6c45bd634c80c59a9f70a92dc70eebec15d4a5e256bf78775e0d3d14f3a0103d9ad8ea6257a0384091f14da59e52581ba2e8ad3adb9747435e9283e8064de21ac41ab2c7b161a3c072b7841d4a594a8b348a923d4cc39f02e05ce95a69c7500c29f6bb415c11e4e0cdb410d0ec2644d6243db38e893c8a3707)</span><br><span class="line">e1=gp.mpz(0xf4c1158f)</span><br><span class="line">c2=gp.mpz(0xd32dfad68d790022758d155f2d8bf46bb762ae5cc17281f2f3a8794575ec684819690b22106c1cdaea06abaf7d0dbf841ebd152be51528338d1da8a78f666e0da85367ee8c1e6addbf590fc15f1b2182972dcbe4bbe8ad359b7d15febd5597f5a87fa4c6c51ac4021af60aeb726a3dc7689daed70144db57d1913a4dc29a2b2ec34c99c507d0856d6bf5d5d01ee514d47c7477a7fb8a6747337e7caf2d6537183c20e14c7b79380d9f7bcd7cda9e3bfb00c2b57822663c9a5a24927bceec316c8ffc59ab3bfc19f364033da038a4fb3ecef3b4cb299f4b600f76b8a518b25b576f745412fe53d229e77e68380397eee6ffbc36f6cc734815cd4065dc73dcbcb)</span><br><span class="line">e2=gp.mpz(0xf493f7d1)</span><br><span class="line">n=gp.mpz(0xa1d4d377001f1b8d5b2740514ce699b49dc8a02f12df9a960e80e2a6ee13b7a97d9f508721e3dd7a6842c24ab25ab87d1132358de7c6c4cee3fb3ec9b7fd873626bd0251d16912de1f0f1a2bba52b082339113ad1a262121db31db9ee1bf9f26023182acce8f84612bfeb075803cf610f27b7b16147f7d29cc3fd463df7ea31ca860d59aae5506479c76206603de54044e7b778e21082c4c4da795d39dc2b9c0589e577a773133c89fa8e3a4bd047b8e7d6da0d9a0d8a3c1a3607ce983deb350e1c649725cccb0e9d756fc3107dd4352aa18c45a65bab7772a4c5aef7020a1e67e6085cc125d9fc042d96489a08d885f448ece8f7f254067dfff0c4e72a63557)</span><br><span class="line">r1, r2, t = exgcd(e1, e2)</span><br><span class="line">m = gp.powmod(c1, r1, n) * gp.powmod(c2, r2, n) % n</span><br><span class="line">#print(m)</span><br><span class="line">#print(hex(m)[2:])</span><br><span class="line">print(bytes.fromhex(str(hex(m)[2:])))</span><br></pre></td></tr></table></figure>

<h2 id="Polybius"><a href="#Polybius" class="headerlink" title="Polybius"></a>Polybius</h2><p>四⭐     BJDCTF</p>
<p>key：波利比奥斯方阵密码 Polybius</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">密文：ouauuuoooeeaaiaeauieuooeeiea</span><br><span class="line">hint：VGhlIGxlbmd0aCBvZiB0aGlzIHBsYWludGV4dDogMTQ=</span><br><span class="line">flag:解出明文后，请加上BJD&#123;&#125;</span><br></pre></td></tr></table></figure>

<p>hint：The length of this plaintext: 14</p>
<p>14×2&#x3D;28</p>
<p>decrypt脚本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">import itertools</span><br><span class="line">ciper = &#x27;ouauuuoooeeaaiaeauieuooeeiea&#x27;</span><br><span class="line">head = &#x27;aeoiu&#x27;</span><br><span class="line">headlist = []</span><br><span class="line">num_headlist = []</span><br><span class="line"></span><br><span class="line"># 先列举出aeiou五种的不同排序</span><br><span class="line">x = itertools.permutations(head,5)</span><br><span class="line">for i in x:</span><br><span class="line">    temp = &quot;&quot;.join(i)</span><br><span class="line">    headlist.append(temp)</span><br><span class="line">print(headlist)</span><br><span class="line"></span><br><span class="line"># 根据aeiou对应的12345修改ciper的对应值，便于后续的遍历得到结果</span><br><span class="line">for i in headlist:</span><br><span class="line">    temp = &#x27;&#x27;</span><br><span class="line">    for j in ciper:</span><br><span class="line">        temp += str(i.index(j) + 1)        </span><br><span class="line">    num_headlist.append(temp)</span><br><span class="line">print(num_headlist)</span><br><span class="line"></span><br><span class="line"># 将ciper对应的数字乘上比例加上96再转为ASCII码，即 可得到对应的字母</span><br><span class="line">for i in num_headlist:</span><br><span class="line">    temp = &#x27;&#x27;</span><br><span class="line">    for j in range(0,len(i),2):</span><br><span class="line">        xx = (int(i[j]) - 1)*5 + int(i[j+1]) + 96   # 前一个为乘上5加上后一个就正好对应了表格中的字母</span><br><span class="line">        if xx&gt;ord(&#x27;i&#x27;):</span><br><span class="line">            xx+=1</span><br><span class="line">        temp += chr(xx)</span><br><span class="line">    print(temp)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="波利比奥斯方阵"><a href="#波利比奥斯方阵" class="headerlink" title="波利比奥斯方阵"></a>波利比奥斯方阵</h3><p>分组密码</p>
<p>波利比奥斯方阵密码在本质上与替换密码相同，但是每个明文字符均被加密为两个密文字符。该密码的安全性较低，当明文长度大于100字符时，甚至可以使用手动进行破解。</p>
<blockquote>
<p>length×2</p>
</blockquote>
<p>eg：使用如下的密钥矩阵加密<code>defend the east wall of the castle</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">   A B C D E</span><br><span class="line">   - - - - -</span><br><span class="line">A| p h q g m</span><br><span class="line">B| e a y l n</span><br><span class="line">C| o f d x k</span><br><span class="line">D| r c v s z</span><br><span class="line">E| w b u t i</span><br></pre></td></tr></table></figure>

<p>加密过程：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">明文:  d e f e n d  t h e  e a s t  w a l l  o f  t h e  c a s t l e </span><br><span class="line">密文:  CCBACBBABECC EDABBA BABBDDED EABBBDBD CACB EDABBA DBBBDDEDBDBA</span><br></pre></td></tr></table></figure>

<p>加密过程显而易见，每个明文字母均被替换为当前行首和列首的两个密文字符，如<code>d-&gt;CC</code></p>
<blockquote>
<p><strong>如果像上文一样生成密钥矩阵，则我们需要记住25个字母。为了简化记忆，我们可以选取一个密钥，然后将其余字母按字母表顺序排列。如密钥为<code>zebra</code>,则可以将密钥扩展为：<code>zebracdfghiklmnopqstuvwxy</code></strong></p>
</blockquote>
<p>依次取密钥中五个字符为一行，生成密钥矩阵即可。</p>
<p>程序实现：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;from pycipher import PolybiusSquare</span><br><span class="line">&gt;&gt;&gt;p = PolybiusSquare(&#x27;phqgiumeaylnofdxkrcvstzwb&#x27;,5,&#x27;ABCDE&#x27;)</span><br><span class="line">&gt;&gt;&gt;p.encipher(&#x27;defend the east wall of the castle&#x27;)</span><br><span class="line">&#x27;CEBCCDBCCBCEEBABBCBCBDEAEBEDBDCACACCCDEBABBCDDBDEAEBCABC&#x27;</span><br><span class="line">&gt;&gt;&gt;p.decipher(&#x27;CEBCCDBCCBCEEBABBCBCBDEAEBEDBDCACACCCDEBABBCDDBDEAEBCABC&#x27;)</span><br><span class="line">&#x27;DEFENDTHEEASTWALLOFTHECASTLE&#x27;</span><br></pre></td></tr></table></figure>

<h2 id="babyhash"><a href="#babyhash" class="headerlink" title="babyhash"></a>babyhash</h2><p>不像一⭐的一⭐    	19护网杯</p>
<blockquote>
<p>一星到wp都没得看o(TヘTo)</p>
</blockquote>
<p>题目.py文件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">from hashlib import sha256</span><br><span class="line">from flag import secret1, secret2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def list_to_hash(l):</span><br><span class="line">    return &#x27;&#x27;.join(map(lambda x: hex(x)[2:].strip(&#x27;L&#x27;).rjust(8, &#x27;0&#x27;), l))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def hash1(message):</span><br><span class="line">    k0, k1, sum = 0x12345678, 0x87654321, 0xcf10f051</span><br><span class="line">    for _ in range(0xFF):</span><br><span class="line">        k1 = (k1 - (((k0 &lt;&lt; 4) + message[2]) ^ (k0 + sum)</span><br><span class="line">                    ^ ((k0 &gt;&gt; 5) + message[3]))) &amp; 0xffffffff</span><br><span class="line">        k0 = (k0 - (((k1 &lt;&lt; 4) + message[0]) ^ (k1 + sum)</span><br><span class="line">                    ^ ((k1 &gt;&gt; 5) + message[1]))) &amp; 0xffffffff</span><br><span class="line">        sum = (sum - 0xdeadbeaf) &amp; 0xffffffff</span><br><span class="line">    return list_to_hash([k0, k1])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def ROL(data, n):</span><br><span class="line">    shift = data &lt;&lt; n</span><br><span class="line">    shift &amp;= 0xffffffff</span><br><span class="line">    carry = data &gt;&gt; (32 - n)</span><br><span class="line">    return shift | carry</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def ROR(data, n):</span><br><span class="line">    shift = data &gt;&gt; n</span><br><span class="line">    carry = data &lt;&lt; (32 - n)</span><br><span class="line">    carry &amp;= 0xffffffff</span><br><span class="line">    return shift | carry</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def hash2(message):</span><br><span class="line">    hashdata = []</span><br><span class="line">    for block in message:</span><br><span class="line">        block ^= 0x12345678</span><br><span class="line">        block = ROR(block, block &amp; 0xF)</span><br><span class="line">        block = (block + 0x87654321) &amp; 0xffffffff</span><br><span class="line">        block = ROL(block, block &amp; 0xF)</span><br><span class="line">        block = (block * 0xdeadbeaf) &amp; 0xffffffff</span><br><span class="line">        if hashdata:</span><br><span class="line">            hashdata.append(block ^ hashdata[-1])</span><br><span class="line">        else:</span><br><span class="line">            hashdata.append(block)</span><br><span class="line">    return list_to_hash(hashdata)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">message = [0xfa9876a2, 0x5188df1a, 0x4da6c4b3, 0x515300db]</span><br><span class="line"></span><br><span class="line"># Level 1</span><br><span class="line">assert hash1(secret1) == hash1(message)</span><br><span class="line">assert all(map(lambda x: 0 &lt;= x &lt;= 0xffffffff, secret1))</span><br><span class="line">assert message != secret1</span><br><span class="line"></span><br><span class="line"># Level 2</span><br><span class="line">assert hash2(secret2) == &#x27;51059dd0e23f4874a8aef600a6979501&#x27;</span><br><span class="line">assert all(map(lambda x: 0 &lt;= x &lt;= 0xffffffff, secret2))</span><br><span class="line"></span><br><span class="line"># If you got multiple solutions, check this.</span><br><span class="line">assert sha256(list_to_hash(secret1)).hexdigest(</span><br><span class="line">) == &#x27;67a21c6e612fbbc3f7facc92989a9967f9cc6d81bb4d7000dbc0dda19d7ef71c&#x27;</span><br><span class="line">assert sha256(list_to_hash(secret2)).hexdigest(</span><br><span class="line">) == &#x27;5cf363de99aa47f535079070e63e38cf6d4fba907e33f5601fac7521cd04ab93&#x27;</span><br><span class="line"></span><br><span class="line">print &#x27;Congratulations! The flag is flag&#123;&#x27; + sha256(list_to_hash(secret1)+list_to_hash(secret2)).hexdigest() + &#x27;&#125;&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>学习ing🎈</p>
<h2 id="Modern-Clueless-Child"><a href="#Modern-Clueless-Child" class="headerlink" title="Modern Clueless Child"></a>Modern Clueless Child</h2><p>五⭐	CSICTF</p>
<p>key：XOR  异或加密及其判断</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#x27;I was surfing the crimson wave and oh my gosh I was totally bugging. I also tried out the lilac hair trend but it didn&#x27;t work out. That&#x27;s not to say you are any better, you are a snob and a half. But let&#x27;s get back to the main question here- Who am I? (You don&#x27;t know my name)&#x27;</span><br><span class="line"></span><br><span class="line">Ciphertext = &quot;52f41f58f51f47f57f49f48f5df46f6ef53f43f57f6cf50f6df53f53f40f58f51f6ef42f56f43f41f5ef5cf4e&quot; (hex)</span><br><span class="line">Key = &quot;12123&quot;</span><br></pre></td></tr></table></figure>

<p>①</p>
<p>I quickly removed the <code>f</code> from cipher text as looked like it was used for space. So I wrote a script <code>sub.py</code> to replace <code>f</code> with <code>&#39;&#39;</code>.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ciphertext = &quot;52f41f58f51f47f57f49f48f5df46f6ef53f43f57f6cf50f6df53f53f40f58f51f6ef42f56f43f41f5ef5cf4e&quot;</span><br><span class="line">sub = ciphertext.replace(&#x27;f&#x27;,&#x27;&#x27;)</span><br><span class="line">print(sub)</span><br></pre></td></tr></table></figure>

<p>I had to check if I am not missing any cipher text so I cross check the flag by XOR checks. So, I wrote this <code>xor1.py</code> script get the <code>csictf&#123;</code> code:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">from pwn import xor</span><br><span class="line">flag = bytes.fromhex(&#x27;52415851475749485d466e5343576c506d53534058516e425643415e5c4e&#x27;)</span><br><span class="line">print(xor(flag, &#x27;csictf&#123;&#x27;.encode()))</span><br><span class="line">#b&quot;1212312+./\r&#x27;%,\x0f#\x040&#x27;&amp;#2\x1d+57&#x27;%?=&quot;</span><br></pre></td></tr></table></figure>

<p>Since we got the key <code>1212312</code> means we are right path as key has cyclic property key (12123). Now it was just replacement on the key with ASCII.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">from pwn import xor</span><br><span class="line">flag = bytes.fromhex(&#x27;52415851475749485d466e5343576c506d53534058516e425643415e5c4e&#x27;)</span><br><span class="line">print(xor(flag, &#x27;12123&#x27;.encode()))</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://noob-atbash.github.io/CTF-writeups/csictf-20/crypto/crypto.html">CRYPTO | CTF Writeups (noob-atbash.github.io)</a></p>
<p>②没有第一个清晰</p>
<p>This question needs a number of observations.</p>
<p>First, it can be seen that <code>f</code> occurs after every 2 characters. Splitting the ciphertext on <code>f</code> yields an array of bytes.</p>
<p>It is known that the flag starts with <code>csictf&#123;</code>. When represented in bytes, this results in an array, <code>63 73 69 63 74 66 7b</code>. On taking an xor of this array with the first 7 elements of the ciphertext, we get a bytearray, <code>31 32 31 32 33 31 32</code>. It can be seen that the unit digit of this bytearray is key.</p>
<p>Hence, taking each element of the key and prepending <code>3</code> before it gives an array of bytes. Taking the xor of this key with the ciphertext returns the flag.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line">cipher = &quot;52f41f58f51f47f57f49f48f5df46f6ef53f43f57f6cf50f6df53f53f40f58f51f6ef42f56f43f41f5ef5cf4e&quot;.split(&#x27;f&#x27;)</span><br><span class="line">key = [&#x27;3&#x27; + i for i in &quot;12123&quot;]</span><br><span class="line">res = []</span><br><span class="line">for i, n in enumerate(cipher):</span><br><span class="line">  x = int(n, 16)</span><br><span class="line">  y = int(key[i % len(key)], 16)</span><br><span class="line">  res.append(hex(x ^ y)[2:])</span><br><span class="line">res = &quot;&quot;.join(res)</span><br><span class="line">print(bytes.fromhex(res).decode())</span><br></pre></td></tr></table></figure>

<h4 id="XOR"><a href="#XOR" class="headerlink" title="XOR"></a>XOR</h4><p>XOR是一种按位运算符，当用来比较的比特位相同时返回0，否则返回1</p>
<img src="/2022/06/26/ctfhub/11.png" class>

<ul>
<li>对于长二进制数字，bit对应bit进行异或</li>
<li>对于十进制整数，将其转化为二进制进行异或操作</li>
<li>对于字符串，将其每个字符转化为代表Unicode字符的整数来对字符串进行异或</li>
</ul>
<h4 id="Properties"><a href="#Properties" class="headerlink" title="Properties"></a>Properties</h4><p>Commutative: A ⊕ B &#x3D; B ⊕ A<br>Associative: A ⊕ (B ⊕ C) &#x3D; (A ⊕ B) ⊕ C<br>Identity: A ⊕ 0 &#x3D; A<br>Self-Inverse: A ⊕ A &#x3D; 0</p>
<p>Below is a series of outputs where three random keys have been XOR’d together and with the flag. Use the above properties to undo the encryption in the final line to obtain the flag.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">KEY1 = a6c8b6733c9b22de7bc0253266a3867df55acde8635e19c73313</span><br><span class="line">KEY2 ^ KEY1 = 37dcb292030faa90d07eec17e3b1c6d8daf94c35d4c9191a5e1e</span><br><span class="line">KEY2 ^ KEY3 = c1545756687e7573db23aa1c3452a098b71a7fbf0fddddde5fc1</span><br><span class="line">FLAG ^ KEY1 ^ KEY3 ^ KEY2 = 04ee9855208a2cd59091d04767ae47963170d1660df7f56f5faf</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Before you XOR these objects, be sure to decode from hex to bytes.</p>
</blockquote>
<p>分析：</p>
<blockquote>
<p>(KEY2 ^ KEY1) ^ KEY1 &#x3D; KEY2 ^ (KEY1 ^ KEY1) &#x3D; KEY2 ^ 0 &#x3D; KEY2</p>
<p>同理</p>
<p>KEY2 ^ (KEY2 ^ KEY3) &#x3D; (KEY2 ^ KEY2) ^ KEY3 &#x3D; 0 ^ KEY3 &#x3D; KEY3</p>
<p>即</p>
<p>(FLAG ^ KEY1 ^ KEY3 ^ KEY2) ^ KEY1 ^ KEY3 ^ KEY2 &#x3D; FLAG</p>
</blockquote>
<p>由XOR的属性可知，如果将两张图片按照像素点进行异或，实际上将会进行两次密钥异或等于0，异或的结果就是原始的两张图片的结合</p>
<p>同样，也可以用Stegsolve 工具进行异或操作</p>
<p>学习ing🎈</p>
<h2 id="simple"><a href="#simple" class="headerlink" title="simple"></a>simple</h2><p>五⭐	网鼎</p>
<p>key： 仿射加密</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">k1:123456   k2:321564  密文为:kgws&#123;m8u8cm65-ue9k-44k5-8361-we225m76eeww&#125;</span><br></pre></td></tr></table></figure>

<p>简单仿射加密，就是123456和26不互素，我们用26的一个素因子13代替26先，得到的答案，可以选择：如果不符合uuid格式，就加个13，不过，后来想想，由于uuid只有abcdef加上 ‘flag’ 的lg，模13其实是足够的。所以其实不需要判断。</p>
<p>由于仿射不加密除字母外的字符，所以直接拼接上来就可以了</p>
<p>确实simple，解密代码就一行：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import inverse</span><br><span class="line">flag = &#x27;&#x27;.join(i if i not in &quot;qwertyuiopasdfghjklzxcvbnm&quot; else chr(((ord(i)-ord(&#x27;a&#x27;) - 321564))*inverse(123456,13)%13+ord(&#x27;a&#x27;)) for i in &#x27;kgws&#123;m8u8cm65-ue9k-44k5-8361-we225m76eeww&#125;&#x27;)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<h2 id="辅助"><a href="#辅助" class="headerlink" title="辅助"></a>辅助</h2><p>五⭐	强网杯</p>
<p>key: 利用公约数分解n</p>
<p>cha.py</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">flag=open(&quot;flag&quot;,&quot;rb&quot;).read()</span><br><span class="line"></span><br><span class="line">from Crypto.Util.number import getPrime,bytes_to_long</span><br><span class="line">p=getPrime(1024)</span><br><span class="line">q=getPrime(1024)</span><br><span class="line">e=65537</span><br><span class="line">n=p*q</span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line">c=pow(m,e,n)</span><br><span class="line">print c,e,n</span><br><span class="line"></span><br><span class="line">p=getPrime(1024)</span><br><span class="line">e=65537</span><br><span class="line">n=p*q</span><br><span class="line">m=bytes_to_long(&quot;1&quot;*32)</span><br><span class="line">c=pow(m,e,n)</span><br><span class="line">print c,e,n</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">output:</span><br><span class="line">2482083893746618248544426737023750400124543452082436334398504986023501710639402060949106693279462896968839029712099336235976221571564642900240827774719199533124053953157919850838214021934907480633441577316263853011232518392904983028052155862154264401108124968404098823946691811798952747194237290581323868666637357604693015079007555594974245559555518819140844020498487432684946922741232053249894575417796067090655122702306134848220257943297645461477488086804856018323986796999103385565540496534422406390355987976815450744535949785073009043007159496929187184338592859040917546122343981520508220332785862546608841127597 65537 14967030059975114950295399874185047053736587880127990542035765201425779342430662517765063258784685868107066789475747180244711352646469776732938544641583842313791872986357504462184924075227433498631423289187988351475666785190854210389587594975456064984611990461126684301086241532915267311675164190213474245311019623654865937851653532870965423474555348239858021551589650169602439423841160698793338115204238140085738680883313433574060243600028500600824624358473403059597593891412179399165813622512901263380299561019624741488779367019389775786547292065352885007224239581776975892385364446446185642939137287519945974807727</span><br><span class="line">3829060039572042737496679186881067950328956133163629908872348108160129550437697677150599483923925798224328175594483217938833520220087230303470138525970468915511111320396185482564783975435346354440035776909781158407636044986403819840648379609630039348895415045723208843631191252142600667607807479954194447237061080618370787672720344741413537975922184859333432197766580150534457001196765621678659952108010596273244230812327182786329760844037149719587269632133595149294067490955644893402708720284179715002149224068928828656515326446881791228638008572889331511945042911372915003805505412099102954073299010951896955362470 65537 14624662628725820618622370803948630854094687814338334827462870357582795291844925274690253604919535785934208081825425541536057550227048399837243392490762167733083030368221240764693694321150104306044125934201699430146970466657410999261630825931178731857267599750324918610790098952520113593130245010530961350592735239454337631927669542026935873535964487595433984902529960726655481696404006628917922241666148082741874033756970724357470539589848548704573091633917869387239324447730587545472564561496724882799495186768858324490838169123077051890332313671220385830444331578674338014080959653201802476516237464651809255679979</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure>

<p>一般解题脚本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line">c1 = </span><br><span class="line">n1 = </span><br><span class="line">c2 = </span><br><span class="line">n2 = </span><br><span class="line">e = 65537</span><br><span class="line">p = gmpy2.gcd(n1, n2)</span><br><span class="line">q = n1 // p</span><br><span class="line">phi = (p - 1) * (q - 1)</span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line"></span><br><span class="line">flag = pow(c1, d, n1)</span><br><span class="line"></span><br><span class="line">print(bytes.fromhex(hex(flag)[2:]))</span><br></pre></td></tr></table></figure>

<h2 id="Mein-Kampf"><a href="#Mein-Kampf" class="headerlink" title="Mein Kampf"></a>Mein Kampf</h2><p>六⭐	CSICTF</p>
<p>key：<a target="_blank" rel="noopener" href="https://pypi.org/project/py-enigma/"><code>py-enigma</code></a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&quot;We have intercepted the enemy&#x27;s communications, but unfortunately, some data was corrupted during transmission. Can you recover the message?&quot; M4 UKW $ Gamma 2 4 $ 5 9 $ 14 3 $ 5 20 fv cd hu ik es op yl wq jm</span><br><span class="line"></span><br><span class="line">&quot;Ciphertext: zkrtwvvvnrkulxhoywoj&quot; (Words in the flag are separated by underscores)</span><br></pre></td></tr></table></figure>

<p>From the communication data format, it is clear that this challenge uses Enigma (the challenge title suggests the same too). However, there are dollar signs in a few places where we don’t know the machine configuration. The only choice is to brute-force through all possibilities and see for which combination we get an output in the correct flag format. For automating this, I used the <a target="_blank" rel="noopener" href="https://pypi.org/project/py-enigma/"><code>py-enigma</code></a> package in Python.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">from enigma.machine import EnigmaMachine </span><br><span class="line">reflectors = [&#x27;B-Thin&#x27;, &#x27;C-Thin&#x27;] </span><br><span class="line">rotors = [&#x27;I&#x27;, &#x27;II&#x27;, &#x27;III&#x27;, &#x27;IV&#x27;, &#x27;V&#x27;, &#x27;VI&#x27;, &#x27;VII&#x27;, &#x27;VIII&#x27;] </span><br><span class="line">for r1 in rotors: </span><br><span class="line">    for r2 in rotors: </span><br><span class="line">        for r3 in rotors: </span><br><span class="line">            for r in reflectors: </span><br><span class="line">                machine = EnigmaMachine.from_key_sheet( </span><br><span class="line">                   rotors=&#x27; &#x27;.join([&#x27;Gamma&#x27;, r1, r2, r3]), </span><br><span class="line">                   reflector=r, </span><br><span class="line">                   ring_settings=&#x27;D I C T&#x27;, </span><br><span class="line">                   plugboard_settings=&#x27;fv cd hu ik es op yl wq jm&#x27;.upper()) </span><br><span class="line">                machine.set_display(&#x27;BENE&#x27;) </span><br><span class="line">                temp = machine.process_text(&#x27;zkrtwvvvnrkulxhoywoj&#x27;) </span><br><span class="line">                if &#x27;CTF&#x27; in temp: </span><br><span class="line">                    print(temp, r1, r2, r3, r)</span><br></pre></td></tr></table></figure>

<p>The output is <code>CSICTFNOSHITSHERLOCK I IV VII B-Thin</code></p>
<h2 id="shenyue2"><a href="#shenyue2" class="headerlink" title="shenyue2"></a>shenyue2</h2><p>六⭐	网鼎</p>
<p>key：费马小定理</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">from gmpy2 import *</span><br><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">import struct</span><br><span class="line">from Crypto.Util import number</span><br><span class="line">from common_math import xgcd, modular_mul_inverse</span><br><span class="line"></span><br><span class="line">FLAG = &quot;************************************&quot;</span><br><span class="line">flag = int(&#x27;0x&#x27;+FLAG.encode(&#x27;hex&#x27;), 16)</span><br><span class="line"></span><br><span class="line">e = 65537</span><br><span class="line">p = number.getPrime(2048)</span><br><span class="line">q = number.getPrime(2048)</span><br><span class="line">r = 663111019425944540514080507309 # number.getPrime(100)</span><br><span class="line">phi = (p-1)*(q-1)</span><br><span class="line">d = modular_mul_inverse(e, phi)</span><br><span class="line">k = (p-r)*d</span><br><span class="line"></span><br><span class="line">enc = powmod(flag, e, p*q)</span><br><span class="line">print &quot;n&quot;, p*q</span><br><span class="line">print &quot;e&quot;, e</span><br><span class="line">print &quot;k&quot;, k</span><br><span class="line">print &quot;enc&quot;, enc</span><br><span class="line"></span><br><span class="line">#n 764789710135699120066739558828098633577013306253421553430847195908034244362783426399681889172711929793563731863384139872322402736681090085666598621114324939409408964563306677742741428195863966989898498906831204752157005288028055139678360291316075877219030667685558110323821117721956754066208709423674599070852863328081495564626811408881020379619280834606394873439653313479059367387482717449792132890040814302415880441497255508283415162957128101398055871020323457216741679183472993371932538507867941404875130906965322325847739960927163953539809036794727803609900302282116111729856921452995125114084009947877974251520302979592670067613546606144401980991349553446645445805493512099309153534117016242573188431650384053169169037929526267038289233193459168030309932136331042640250813278140485915435024593329769782476261202489190771392735516338128092461124553594475652005536021219004598007475896848018535883345275525698202912140165492830229318458220859621536946916060728450732293426918231002157025978449298255884607961112874423611768107044113994666509578842156149561812558917421973274685922015605898024562717582262195308188734233843441532414373538708641762976079302448555298697105806160447760545580129674268456624678445339254341281619657391</span><br><span class="line">#e 65537</span><br><span class="line">#k 11376230879464757138290711299984908778464289005173308608189545435463525777268265977729128994228398091834020517958489408848527244519720030536561582611244172458641332639632981518360153087977263620583037286868169984156081495975325137150308201181821183705406433865681037783672009245951450744893423967519534524564872374719067025656950703655360275719627553370956932353637447232396991057691540662128565377895571740302756624004115592822652032877787683190174651306416910281916239819514603714322474683948222133746696116347630808594215555899448203106168014521796360515931362871133025281314243806320464177354177591228332335003551614106832308993911767231860241219942930903683175017203214440697826698228720134550320203010201162227480574211558033922830875117868895970801183417628548046732735178684031479465866770555097097049039401697156697973726498505003813383696303149763801522877588926847414588086172187481338569607545109010485980789181176815929895776940791230453092924387422291052184177606568352378605741988346025715326590594607822822612290794021218154340474272030636989456754518795702696600378337733961339618639033487933752890208434609460829539754273357617487166483257224739734126886305602260084115687043018921964438528469917594211427068125222889990486298031116975211308319185008573568652053973895884503801570264426091699176024805955546836991196229298757508243251307657063191639987383783941231455894746140575040062497070116929901714063774213552073013057990495816268901523247960107878691144148350592800965125699719038873342744331101838577313168280165305316417387319080806526792235761499758367535234473231638455540814177514642349235328627096125963532214440347089295557895745448430528014032156116184317483847359679936198373071447646642313893200567858353913090847963730766120387076016399374559419994285225024354973914324859198201290795827297428960819444555465333396</span><br><span class="line">#enc 519467713751094904598159022987103691511259274774209441519584888564069062035542644790087060987328959901741258501300093004420044123445481880407931231251958038012202388431636518139006455080522439415387864531982679321682285383734096803256001152937208459295510574757774947236169715202686520555856020855830320306057953008472084296427565355650566174395167777311640285184545830854189876412541067203365997646606165015569235777861406389883205463918051602307946299751610157571027193186245476691847563482840661345021243975217146282342518010810920020230971527413391779187267622754114008860968975577345904021780725192599110737273118516636021100280200540920405328862817744421031962393190088934140614567426323356145174745440656955066066262578429403793555647695057101961696889758526647133883002687772114221068613633288847933578978346227331298499828986369407775151906995962535008597673126821214853383052870910694479916045213576126805625271271078396132288268874265020044328933205952291855156951015240630266575353489117982749485099045184565551566699809425298560358547342684827513213367310680503970306410329482201797661612173789624356845997386309143966652007299888088648017505165599209010954534155765247032891935634559101027944693354146550957638840559533</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>







<h2 id="破解加密数据"><a href="#破解加密数据" class="headerlink" title="破解加密数据"></a>破解加密数据</h2><p>五⭐	ICSC</p>
<p>key：RSA</p>
<p>某工控厂商自行研发了一套加密系统，这样的话只要不是系统内部人员，即使数据被窃听没关系了。你截获了一段密文：109930883401687215730636522935643539707，请进行解密，flag形式为 flag{}</p>
<p><a target="_blank" rel="noopener" href="https://writeup.ctfhub.com/Challenge/2019/%E5%B7%A5%E4%B8%9A%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B/%E5%B1%B1%E4%B8%9C%E7%AB%99/it2BmKggi3QFR2mdJgcD1M.html">破解加密数据 | CTFHub</a></p>
<h2 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h2><p>六⭐	百越杯</p>
<h2 id="hafuhafu"><a href="#hafuhafu" class="headerlink" title="hafuhafu"></a>hafuhafu</h2><p>六⭐	网鼎</p>
<p>key：生成pem、rsatool</p>
<p>os：这又都是什么鬼🔥</p>
<blockquote>
<p>enc是加密后的文件，pem是公钥&#x2F;私钥。这就很明显了，我们需要找到私钥，然后去解密flag.enc。这个其实就已经涉及到具体的实际应用上了，跟以往的直接给数字的RSA解密还是有一些不同的。</p>
<p><a target="_blank" rel="noopener" href="https://shawroot.hatenablog.com/entry/2019/09/25/_2018%E7%BD%91%E9%BC%8E%E6%9D%AF%E7%AC%AC3%E5%9C%BA-_hafuhafu_%EF%BC%88%E7%94%9F%E6%88%90pem%EF%BC%89">2018网鼎杯第3场- hafuhafu （生成pem） - 「配枪朱丽叶。」 (hatenablog.com)</a></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">pk = (25572000680139535995611501720832880791477922165939342981900803052781801299380515116746468338767634903543966903733806796606602206278399959935132433794098659859300196212479681357625729637405673432324426686371817007872620401911782200407165085213561959188129407530503934445657941975876616947807157374921539755157591354073652053446791467492853468641331291383821277151309959102082454909164831353055082841581194955483740168677333571647148118920605752176786316535817860771644086331929655259439187676703604894258185651165017526744816185992824404330229600417035596255176459265305168198215607187593109533971751842888237880624087,65537)</span><br><span class="line">------ enc -------</span><br><span class="line">DTlEiAKLE24m19es4TBWl4Uo2MvmQMEYqWBCFggWJlJSjCwl3fT9322ytgudiQW2raDh53e6t2ed</span><br><span class="line">ygpFOP+MsAPXlU469rlmVng5JyDl0CF0ypevnaM5i+CvNT2mBoDadIYnPBVGMtj9HVVPDpMIgv5b</span><br><span class="line">F9N5ddQS7JB21oDdQBdDLTkKvcSqegtjNFv04R8+yrqOMZYpzdCRRw0j/MMt2JefC6z36mjrTL85</span><br><span class="line">A9EKlwKg5ydW7qELycfjBvzB/cwJ7mJ2I0xVPToa3sSLNDyddFttATwU6wmCa4XaWpTwVR/PfET2</span><br><span class="line">FRj0p+8UwYSDdlLLh6gRUVURpT+2jc9zx/rhOw==</span><br></pre></td></tr></table></figure>

<p>分解p、q</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">p = 149930380465516707151079321019435489399072155945793735032334088844599773034021170995501688132861944516938448679935403246643441984203770825485165700862168437691254557323938150173733659070945061763789341407547559935070758242521126066900261360899379463301621378242061934281538210192731229473900396425739817670867</span><br><span class="line">q =</span><br><span class="line">170559166199281256887953076784727902849936084815549184550874370897326056825177365209113910954088389779180174518262922176726833811470419181874717574929460298509184863124213663255559781224744696195678069242025195218017449489985102637547369070225979448169459840545693721393354651993457943927480894225788038743661</span><br></pre></td></tr></table></figure>

<p>利用<a target="_blank" rel="noopener" href="https://github.com/ius/rsatool">rsatool</a>生成pem文件<br>命令： <a target="_blank" rel="noopener" href="http://d.hatena.ne.jp/keyword/python">python</a>rsatool.py -p xxx -q xxx -e xxx -o pen.pem</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python rsatool.py -p 149930380465516707151079321019435489399072155945793735032334088844599773034021170995501688132861944516938448679935403246643441984203770825485165700862168437691254557323938150173733659070945061763789341407547559935070758242521126066900261360899379463301621378242061934281538210192731229473900396425739817670867  -q 170559166199281256887953076784727902849936084815549184550874370897326056825177365209113910954088389779180174518262922176726833811470419181874717574929460298509184863124213663255559781224744696195678069242025195218017449489985102637547369070225979448169459840545693721393354651993457943927480894225788038743661 -e 65537 -o pen.pem</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 rsatool.py -f PEM -o private.pem -p 149930380465516707151079321019435489399072155945793735032334088844599773034021170995501688132861944516938448679935403246643441984203770825485165700862168437691254557323938150173733659070945061763789341407547559935070758242521126066900261360899379463301621378242061934281538210192731229473900396425739817670867 -q 170559166199281256887953076784727902849936084815549184550874370897326056825177365209113910954088389779180174518262922176726833811470419181874717574929460298509184863124213663255559781224744696195678069242025195218017449489985102637547369070225979448169459840545693721393354651993457943927480894225788038743661 -e 65537</span><br></pre></td></tr></table></figure>



<h2 id="GM"><a href="#GM" class="headerlink" title="GM"></a>GM</h2><p>七⭐	虎符</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://hackerv27.github.io">hackerv27</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://hackerv27.github.io/2022/06/26/ctfhub/">http://hackerv27.github.io/2022/06/26/ctfhub/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://hackerv27.github.io" target="_blank">早安Flag</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/wp/">wp</a></div><div class="post_share"><div class="social-share" data-image="/img/7.png" data-sites="wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/gh/overtrue/share.js@master/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.ipg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.ipg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/06/27/cry/"><img class="prev-cover" src="/img/6.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">CTF特训营</div></div></a></div><div class="next-post pull-right"><a href="/2022/06/20/ctf/"><img class="next-cover" src="/img/9.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">22国赛</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/08/08/4/" title="2022强网杯"><img class="cover" src="/img/11.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-08</div><div class="title">2022强网杯</div></div></a></div><div><a href="/2022/07/14/buu/" title="22NepCTF"><img class="cover" src="/img/6.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-07-14</div><div class="title">22NepCTF</div></div></a></div><div><a href="/2022/06/20/ctf/" title="22国赛"><img class="cover" src="/img/9.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-06-20</div><div class="title">22国赛</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div id="comment-switch"><span class="first-comment">Valine</span><span class="switch-btn"></span><span class="second-comment">Disqus</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div><div><div id="disqus_thread"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/1.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">hackerv27</div><div class="author-info__description">( •̀ ω •́ )y</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">13</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">6</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/hackerv27"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/hackerv27" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:you_fr@163.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">我要种一片青青草原</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#CTFHub"><span class="toc-number">1.</span> <span class="toc-text">CTFHub</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#you-raise-me-up"><span class="toc-number">1.1.</span> <span class="toc-text">you_raise_me_up</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#sage%E4%B9%8B%E7%A6%BB%E6%95%A3%E5%AF%B9%E6%95%B0%E6%B1%82%E8%A7%A3"><span class="toc-number">1.1.1.</span> <span class="toc-text">sage之离散对数求解</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#shanghai"><span class="toc-number">1.2.</span> <span class="toc-text">shanghai</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#little-RSA"><span class="toc-number">1.3.</span> <span class="toc-text">little RSA</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#RSA%E7%AE%80%E5%8D%95%E5%85%A5%E9%97%A8"><span class="toc-number">1.3.1.</span> <span class="toc-text">RSA简单入门</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#RSA%E5%85%AC%E9%92%A5%E5%AF%86%E7%A0%81"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">RSA公钥密码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#RSA%E5%B8%B8%E8%A7%81%E9%A2%98%E5%9E%8B"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">RSA常见题型</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9C%80%E7%AE%80%E5%8D%95%E7%9A%84"><span class="toc-number">1.3.1.2.1.</span> <span class="toc-text">最简单的</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E5%85%AC%E7%BA%A6%E6%95%B0%E5%88%86%E8%A7%A3n"><span class="toc-number">1.3.1.2.2.</span> <span class="toc-text">利用公约数分解n</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%88%86%E7%A0%B4e"><span class="toc-number">1.3.1.2.2.1.</span> <span class="toc-text">爆破e</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB"><span class="toc-number">1.3.1.2.3.</span> <span class="toc-text">共模攻击</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%80%83%E6%95%B0%E5%AD%A6b%EF%BC%88%EF%BF%A3%E2%96%BD%EF%BF%A3%EF%BC%89d"><span class="toc-number">1.3.1.2.4.</span> <span class="toc-text">考数学b（￣▽￣）d</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BB%B4%E7%AD%94%E6%BB%B4%E7%AD%94"><span class="toc-number">1.4.</span> <span class="toc-text">滴答滴答</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E7%A0%81%E4%B8%8E%E8%B0%83%E5%88%B6"><span class="toc-number">1.5.</span> <span class="toc-text">编码与调制</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rand"><span class="toc-number">1.6.</span> <span class="toc-text">rand</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#boom"><span class="toc-number">1.7.</span> <span class="toc-text">boom</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Not-only-base"><span class="toc-number">1.8.</span> <span class="toc-text">Not_only_base</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#base%EF%BC%9F%EF%BC%9F"><span class="toc-number">1.9.</span> <span class="toc-text">base？？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Quick-Math"><span class="toc-number">1.10.</span> <span class="toc-text">Quick Math</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#track-hacker"><span class="toc-number">1.11.</span> <span class="toc-text">track_hacker</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Rivest-Shamir-Adleman"><span class="toc-number">1.12.</span> <span class="toc-text">Rivest Shamir Adleman</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rosb"><span class="toc-number">1.13.</span> <span class="toc-text">rosb</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Polybius"><span class="toc-number">1.14.</span> <span class="toc-text">Polybius</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%A2%E5%88%A9%E6%AF%94%E5%A5%A5%E6%96%AF%E6%96%B9%E9%98%B5"><span class="toc-number">1.14.1.</span> <span class="toc-text">波利比奥斯方阵</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#babyhash"><span class="toc-number">1.15.</span> <span class="toc-text">babyhash</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Modern-Clueless-Child"><span class="toc-number">1.16.</span> <span class="toc-text">Modern Clueless Child</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#XOR"><span class="toc-number">1.16.0.1.</span> <span class="toc-text">XOR</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Properties"><span class="toc-number">1.16.0.2.</span> <span class="toc-text">Properties</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#simple"><span class="toc-number">1.17.</span> <span class="toc-text">simple</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BE%85%E5%8A%A9"><span class="toc-number">1.18.</span> <span class="toc-text">辅助</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mein-Kampf"><span class="toc-number">1.19.</span> <span class="toc-text">Mein Kampf</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#shenyue2"><span class="toc-number">1.20.</span> <span class="toc-text">shenyue2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A0%B4%E8%A7%A3%E5%8A%A0%E5%AF%86%E6%95%B0%E6%8D%AE"><span class="toc-number">1.21.</span> <span class="toc-text">破解加密数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RSA"><span class="toc-number">1.22.</span> <span class="toc-text">RSA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hafuhafu"><span class="toc-number">1.23.</span> <span class="toc-text">hafuhafu</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GM"><span class="toc-number">1.24.</span> <span class="toc-text">GM</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/09/15/1/" title="一地鸡毛">一地鸡毛</a><time datetime="2022-09-15T14:09:51.000Z" title="发表于 2022-09-15 22:09:51">2022-09-15</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/08/22/b/" title="关于小站优化">关于小站优化</a><time datetime="2022-08-21T21:02:18.000Z" title="发表于 2022-08-22 05:02:18">2022-08-22</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/08/10/10/" title="消灭密码doge">消灭密码doge</a><time datetime="2022-08-10T09:51:39.000Z" title="发表于 2022-08-10 17:51:39">2022-08-10</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/08/08/6/" title="相约海大">相约海大</a><time datetime="2022-08-08T14:01:05.000Z" title="发表于 2022-08-08 22:01:05">2022-08-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/08/08/4/" title="2022强网杯">2022强网杯</a><time datetime="2022-08-07T17:05:45.000Z" title="发表于 2022-08-08 01:05:45">2022-08-08</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 By hackerv27</div><div class="footer_custom_text">Hi, welcome to my <a target="_blank" rel="noopener" href="https://butterfly.js.org/">blog</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="聊天"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: '',
      appKey: '',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script>function loadDisqus () {
  var disqus_config = function () {
    this.page.url = 'http://hackerv27.github.io/2022/06/26/ctfhub/'
    this.page.identifier = '2022/06/26/ctfhub/'
    this.page.title = 'Hubcry'
  };

  window.disqusReset = () => {
    DISQUS.reset({
      reload: true,
      config: disqus_config
    })
  }

  if (window.DISQUS) disqusReset()
  else {
    (function() { 
      var d = document, s = d.createElement('script');
      s.src = 'https://.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  }
}

if ('Valine' === 'Disqus' || !false) {
  if (false) btf.loadComment(document.getElementById('disqus_thread'), loadDisqus)
  else loadDisqus()
} else {
  function loadOtherComment () {
    loadDisqus()
  }
}
</script></div><div class="aplayer no-destroy" data-id="60198" data-server="netease" data-type="playlist" data-fixed="true" data-autoplay="true"> </div><canvas class="fireworks" mobile="true"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script>(function(d, w, c) {
    w.ChatraID = 'PbGL3JSSSfT3Kbda4';
    var s = d.createElement('script');
    w[c] = w[c] || function() {
        (w[c].q = w[c].q || []).push(arguments);
    };
    s.async = true;
    s.src = 'https://call.chatra.io/chatra.js';
    if (d.head) d.head.appendChild(s);
})(document, window, 'Chatra');

if (true) {
  var chatBtnFn = () => {
    var chatBtn = document.getElementById("chat_btn")
    chatBtn.addEventListener("click", function(){
      Chatra('openChat')
    });
  }
  chatBtnFn()
} else {
  if (true) {
    function chatBtnHide () {
      Chatra('hide')
    }
    function chatBtnShow () {
      Chatra('show')
    }
  }
}</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer@1/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>
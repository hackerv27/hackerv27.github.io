<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>CTFhub | æ—©å®‰Flag</title><meta name="keywords" content="wp"><meta name="author" content="hackerv27,you_fr@163.com"><meta name="copyright" content="hackerv27"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="CTFhubå­¦ä¹ ingğŸˆ you_raise_me_upå››â­ç½‘é¼é’é¾™ key: æ ‡å‡†ç¦»æ•£å¯¹æ•°é—®é¢˜ã€sympyæ•°å­¦è®¡ç®—åº“ é¢˜ç›®ï¼š 12345678910111213#!&#x2F;usr&#x2F;bin&#x2F;env python# -*- coding: utf-8 -*-from Crypto.Util.number import *import randomn &#x3D; 2 ** 512m &#x3D; random.randin">
<meta property="og:type" content="article">
<meta property="og:title" content="CTFhub">
<meta property="og:url" content="http://hackerv27.github.io/2022/06/26/ctfhub/">
<meta property="og:site_name" content="æ—©å®‰Flag">
<meta property="og:description" content="CTFhubå­¦ä¹ ingğŸˆ you_raise_me_upå››â­ç½‘é¼é’é¾™ key: æ ‡å‡†ç¦»æ•£å¯¹æ•°é—®é¢˜ã€sympyæ•°å­¦è®¡ç®—åº“ é¢˜ç›®ï¼š 12345678910111213#!&#x2F;usr&#x2F;bin&#x2F;env python# -*- coding: utf-8 -*-from Crypto.Util.number import *import randomn &#x3D; 2 ** 512m &#x3D; random.randin">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://hackerv27.github.io/img/7.png">
<meta property="article:published_time" content="2022-06-26T15:24:52.000Z">
<meta property="article:modified_time" content="2022-06-27T14:36:55.344Z">
<meta property="article:author" content="hackerv27">
<meta property="article:tag" content="wp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://hackerv27.github.io/img/7.png"><link rel="shortcut icon" href="/img/1.jpg"><link rel="canonical" href="http://hackerv27.github.io/2022/06/26/ctfhub/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'å¤©',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: {"limitCount":50,"languages":{"author":"ä½œè€…: hackerv27","link":"é“¾æ¥: ","source":"æ¥æº: æ—©å®‰Flag","info":"è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'CTFhub',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-06-27 22:36:55'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.2.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">åŠ è½½ä¸­...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/1.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">6</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">3</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-graduation-cap"></i><span> Blog</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> categories</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> tags</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> archives</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> Share</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/photos/"><i class="fa-fw fa fa-camera-retro"></i><span> photo/</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/7.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">æ—©å®‰Flag</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-graduation-cap"></i><span> Blog</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> categories</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> tags</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> archives</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> Share</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/photos/"><i class="fa-fw fa fa-camera-retro"></i><span> photo/</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">CTFhub</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2022-06-26T15:24:52.000Z" title="å‘è¡¨äº 2022-06-26 23:24:52">2022-06-26</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2022-06-27T14:36:55.344Z" title="æ›´æ–°äº 2022-06-27 22:36:55">2022-06-27</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF/">CTF</a></span></div><div class="meta-secondline"></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="CTFhub"><a href="#CTFhub" class="headerlink" title="CTFhub"></a>CTFhub</h1><p>å­¦ä¹ ingğŸˆ</p>
<h2 id="you-raise-me-up"><a href="#you-raise-me-up" class="headerlink" title="you_raise_me_up"></a>you_raise_me_up</h2><p>å››â­ç½‘é¼é’é¾™</p>
<p>key: æ ‡å‡†ç¦»æ•£å¯¹æ•°é—®é¢˜ã€sympyæ•°å­¦è®¡ç®—åº“</p>
<p>é¢˜ç›®ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">import random</span><br><span class="line"></span><br><span class="line">n = 2 ** 512</span><br><span class="line">m = random.randint(2, n-1) | 1</span><br><span class="line">c = pow(m, bytes_to_long(flag), n)</span><br><span class="line">print &#x27;m = &#x27; + str(m)</span><br><span class="line">print &#x27;c = &#x27; + str(c)</span><br><span class="line"></span><br><span class="line"># m = 391190709124527428959489662565274039318305952172936859403855079581402770986890308469084735451207885386318986881041563704825943945069343345307381099559075</span><br><span class="line"># c = 6665851394203214245856789450723658632520816791621796775909766895233000234023642878786025644953797995373211308485605397024123180085924117610802485972584499</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä»£ç æ„æ€ï¼šæ±‚æ»¡è¶³mçš„bytes_to_long(flag)æ¬¡æ–¹ï¼Œå¯¹nå–æ¨¡çš„flagå€¼</p>
<p>powå‡½æ•°æ˜¯è®¡ç®—xçš„yæ¬¡æ–¹ï¼Œå¦‚æœzåœ¨å­˜åœ¨ï¼Œåˆ™å†å¯¹ç»“æœè¿›è¡Œå–æ¨¡ï¼Œå…¶ç»“æœç­‰æ•ˆäºpow(x,y) %z</p>
<p>psï¼šå„ä¸ªç¯å¢ƒä¸‹%è¿ç®—ç¬¦çš„å«ä¹‰ä¸åŒï¼Œæ¯”å¦‚c&#x2F;c++ï¼Œjava ä¸ºå–ä½™ï¼Œè€Œpythonåˆ™ä¸ºå–æ¨¡</p>
</blockquote>
<p>æ„é€ è„šæœ¬</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">m = 391190709124527428959489662565274039318305952172936859403855079581402770986890308469084735451207885386318986881041563704825943945069343345307381099559075</span><br><span class="line">c = 6665851394203214245856789450723658632520816791621796775909766895233000234023642878786025644953797995373211308485605397024123180085924117610802485972584499</span><br><span class="line">n = 2 ** 512</span><br><span class="line"></span><br><span class="line">import sympy</span><br><span class="line">flag=sympy.discrete_log(2**512,c,m)#æ±‚ç¦»æ•£å¯¹æ•°</span><br><span class="line">import binascii</span><br><span class="line">print(binascii.unhexlify(hex(flag)[2:]))#å°†ç­”æ¡ˆçš„åå…­è¿›åˆ¶è½¬å‡ºæ¥</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<h6 id="binascii-â€”-äºŒè¿›åˆ¶å’Œ-ASCII-ç äº’è½¬"><a href="#binascii-â€”-äºŒè¿›åˆ¶å’Œ-ASCII-ç äº’è½¬" class="headerlink" title="binascii â€” äºŒè¿›åˆ¶å’Œ ASCII ç äº’è½¬"></a><a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3/library/binascii.html#module-binascii"><code>binascii</code></a> â€” äºŒè¿›åˆ¶å’Œ ASCII ç äº’è½¬</h6></blockquote>
<h3 id="sageä¹‹ç¦»æ•£å¯¹æ•°æ±‚è§£"><a href="#sageä¹‹ç¦»æ•£å¯¹æ•°æ±‚è§£" class="headerlink" title="sageä¹‹ç¦»æ•£å¯¹æ•°æ±‚è§£"></a>sageä¹‹ç¦»æ•£å¯¹æ•°æ±‚è§£</h3><p>sageä¸­æ±‚è§£ç¦»æ•£å¯¹æ•°æˆ‘ç›®å‰çŸ¥é“çš„å››ä¸ªå‡½æ•°ï¼š</p>
<p>(1)discrete_logï¼šé€šç”¨çš„æ±‚ç¦»æ•£å¯¹æ•°çš„æ–¹æ³•ï¼šdiscrete_log(a,base,ord,operation)</p>
<p>(2)discrete_log_rhoï¼šæ±‚ç¦»æ•£å¯¹æ•°çš„Pollard-Rhoç®—æ³•ï¼šdiscrete_log_rho(a,base,ord,operation)</p>
<p>(3)discrete_log_lambdaï¼šæ±‚ç¦»æ•£å¯¹æ•°çš„Pollard-kangarooç®—æ³•ï¼ˆä¹Ÿç§°ä¸ºlambdaç®—æ³•ï¼‰ï¼šdiscrete_log_lambda(a,base,bounds,operation)</p>
<p>(4)bsgsï¼šå°æ­¥å¤§æ­¥æ³•ï¼šbsgs(base,a,bounds,operation)</p>
<blockquote>
<p>å‚æ•°è¯´æ˜ï¼šæ±‚è§£ä»¥baseä¸ºåº•ï¼Œaçš„å¯¹æ•°ï¼›ordä¸ºbaseçš„é˜¶ï¼Œå¯ä»¥ç¼ºçœï¼Œoperationå¯ä»¥æ˜¯â€™+â€™ä¸â€™<em>â€˜ï¼Œé»˜è®¤ä¸ºâ€™</em>â€˜ï¼›boundsæ˜¯ä¸€ä¸ªåŒºé—´(ld,ud)ï¼Œéœ€è¦ä¿è¯æ‰€è®¡ç®—çš„å¯¹æ•°åœ¨æ­¤åŒºé—´å†…ã€‚</p>
</blockquote>
<p>å¾…å­¦ä¹ ğŸˆ</p>
<h2 id="shanghai"><a href="#shanghai" class="headerlink" title="shanghai"></a>shanghai</h2><p>ä¸‰â­ç½‘é¼</p>
<p>keyï¼šç»´å‰å°¼äºš  vigenÃ¨re</p>
<blockquote>
<p>æ‰“å¼€é¢˜ç›®åï¼Œæœ‰ç‚¹ææƒš</p>
<p>å¤§è‡´æµè§ˆï¼ŒæŸ¥æ‰¾flagã€keyã€{ }</p>
<p>å¯ä»¥å‘ç°ä¸€æ®µæ–‡æœ¬â€™{â€˜ vvj â€˜zvkvrmtudabiecveaaxppâ€™ grq â€˜}â€™    çŒœæµ‹æœ‰flag</p>
<p>å¾—çŸ¥é“è¿™æ˜¯vigenereç±»å‹ï¼ˆè¿™æˆ‘æ€ä¹ˆçŸ¥é“ï¼Ÿï¼Ÿï¼Ÿæˆ–è®¸çœ‹vvjï¼Ÿï¼‰</p>
<p>è¿˜è¦æ‰¾åˆ°å¯†é’¥ï¼ˆğŸ‘ï¼‰çœ‹äº†ä¸€ä½uuå†™çš„æ‰¾å¯†é’¥è¿‡ç¨‹ï¼Œçœ‹å¾—æˆ‘æœ‰ç‚¹è¿·ç³Š</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/ta0tie/articles/15493969.html">WP-Crypto-shanghai-ç»´å‰å°¼äºšå¯†ç  - ta0tie - åšå®¢å›­ (cnblogs.com)</a></p>
<p>å¯†é’¥ï¼švigenereicq</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">bju lcogx fisep vjf pyztj sdgh 13 gifc qsxw. pkiowxc</span><br><span class="line">glv jqtio ekpy-hfgcouibkh qijgzkfoqur bj r twnovtvlnfvxqe sdxnie arw nqhhcregiu fg nujv hegxzwbc qgjkvgm rvwwdy 1467 ith hwvh i ouoir gvtyiz fynk zs fazxkj rzbcirr tmxjum irtuesibu. qgjkvgm&#x27;j wgujzu uryc jaqvscmj eytyejgjn ilxrv jidghvt csehj, evf irqzguij amtu dvjmpekil do rzoxvrx xpg bzbzie sw xpg sjzxiftfrlkdb irtuesib kd opk gvtyizvusb. regii, mv 1508, lecitrrw kvqvxzuoyf, me lqu mjzq tbpzkzcfcqg, mazvrbgt opk xnflpi tuxbg, e pvzxqeqg kuqcseivv ea bni imxivÃ¨tu xqvlrv. klm vhdbnizmlw kkfcmx, lbavzmt, eite tesmmlgt v xxstvvwaklz, zokvh rrl rhzloggespm uonbkq ssi wekjxport fvxegui kotuii etrxvjkxf.[gzxivyjv tirhvh]</span><br><span class="line"></span><br><span class="line">ejqo qy rba brwyd va zlr zzkmpÃ¨hz kotuii aiu emqmmaecpg funkxmoiu fg iyjdgr oekxqujv jkpyejs qp xda 1553 hsbo ce kkvmi jiy wzk. okeqit fnxkmavq wmrpnwf.[4] lm dkdtz ycse xpg jvjapn vvgbc ea bxmglvqqwi wcz eqhvh i tukmgxvrx &quot;gwwdomxwvke&quot; (e sgo) ow yavxtl kkfcmx eytyejgjn mbiec cibvum. enieirw inrzzzm nru xzkjcmsmhw lwmf q aqdiq trxbghi wl whfjxqvkoqurf, fvptcij&#x27;a yguidi ugqib zlr trxbghi wl whfjxqvkoqurf gfytf rz mgwvpp gpcdbmj, wvqgpg do nmripxzro c dze qil. ovca yumm zccmtetno nqtkyi nszfi jz ylbvk tptqnmy, oasnr bq rjbn tnvkmmu yi ijznrti, wt jmitwzmkxmf &quot;epb uj oeeh&quot; ineio cmgl klm ounagkr. fvptcij&#x27;a siglfh bjkn zkuhmiil ujmwtk fityzkjt nuv brcc bju fme. ef mk ma tugizmiicc mcit bu wrglvm c icwxx xip tptqnm, yypl rw ja q kzkzvslw xtyqizi psezmtivbosa, fvptcij&#x27;a ycfxvq eci xwtwvhvvidbt uuvr wvgctu.[xqzegmfr vguymj]</span><br><span class="line"></span><br><span class="line">fyezwm fu qqmiaÃ¨vv tcdbdaniq lzw lgixzotgmfr wh q nqsmyei fcv iozurtii ecvefme gvtyiz duawxi glv gwwho wl lrric qky jn lvnrti, qp 1586.[5] bvbkv, vr klm 19vx xmtxhvp, xpg yidkrgmfr wh rztrefs&#x27;j gqrxzz cef qzwivjmqhygiu xw xybmtÃ¨vr. hrzqf avpt, ma lzw jqef, bni psuijtuvskvf prqmpjzl zlr qzwivjmqhygmfr ja ivgort xyeb jynbuvl lrh &quot;qidjzkh glzw qofjzzeax tsvvhdjaxvse evf yiazinh eeugt v zkkeijwqxu vvj iyidivvqmg imclvv nqh cqs [zvkvrÃ¨zg] jcwaku lv lif djbnmak ks lq mdbn mg&quot;.[6]</span><br><span class="line"></span><br><span class="line">xyi dkwzvÃ¨xi pmglmt wvqtiq e iixwjvbosa jfv jgyio kbpigxqqdvtrc fxisvi. djbkh nyklwt qil seglvqivyxqgr plrvtgi gczavhxi lqtbaur (yinma eqmzupy) grptgt opk zvkvrÃ¨zg sdxnie yefzgqfihpr me lqu 1868 fdmii &quot;glv etrxvjkx pmglmt&quot; yi i ilvpuvmp&#x27;i himemmei. qp 1917, ixqkrgmwmk cczzognr uiaehdjkh glv zqiuiÃ¨zk gvtyiz ci &quot;duvsfwzftg ea bxeawcebkei&quot;.[7][8] bneg vvtcvqoqur jej rwv tzakviiu. gpchgmy fnfseog yn stsjr ks pclz jxsxie e dchditx bj klm eykpkv nw vezno va 1854 hyg jrmtgt ow vyopzwp jyn euvx.[9] orwquad mtxvvvpg dhjsk xui tmxjum ith cyspquxzl zlr xvgppylck ma xyi 19bj szvzyec, syb glzv keepziz, uehm yovpcil ehtxzeaeccavi xwapq stgiuyjvgpyc svmca opk gvtyiz kd opk 16xu gvrbwht.[6]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">kxccxfkzcfcqi wymui zwbz cyiq ej e kcbxcregmfr ikt wg zlr wnmau qmue frxnimp 1914 qil 1940.</span><br><span class="line">zlr zzkmpÃ¨hz kotuii ma uyhxri rrfyoj jj jk e smvpl eykpkv vj zx qu knmj ma gfrrwdxbosa azxp eykpkv qmjoa.[10] vxz kursiuizcjz azegij sn cczzogn, jfv mzqhxri, hwvh i dhvay gvtyiz fyns zs vqgpmouib zlr zzkmpÃ¨hz kotuii hctyio zlr edizksvv imimc ait. jcm isajvhmtqxg&#x27;y qrwjeogi rmxi sei jzqc nmivrx, rrl vxz ctmbr iiowbvzrc pvrgsgt dby qrwjeogi. opxshkyscv jcm cee, xyi kqdamjieeki tgqymxwumg tzkcvzopl vvpqgt pxur gliim mut xnvnwvw: &quot;ucdxpkwgii ftwva&quot;, &quot;kuqcpvxm xyxbuvl&quot; eeh, iu jcm cee grqm ve v krsfi, &quot;tsug hzbxmoykmwp&quot;.[11]</span><br><span class="line"></span><br><span class="line">wdthiex mizpqh bxmrh ks zgfvqx xui svwmui kotuii (gzgqoqtk glv zmtdvuâ€“bmtieÃ¨vm eykpkv vr 1918), syb pe hizxrv nliv xz loh, glv gqrxzz cef wkmtn lpttieespm ve xzetgeeetaida. bierrq&#x27;a yems, nsjimiz, glzvzynpcc tgt ow zlr sei-bkcz xgh, n xyiwtuoqieypp-yvdhziqeopv gqrxzz.[12]</span><br><span class="line"></span><br><span class="line">jifgimxvyjv</span><br><span class="line"></span><br><span class="line">zlr zzkmpÃ¨hz awynvv sz xybmtÃ¨vr xrftg, qgau oasnr iu jcm zeoyce zgsoi, iea fv yagt awx iagicxvyjv grq hvgzafoqur.</span><br><span class="line">vr r gigivz imclvv, mcsc tkxgii sn vxz irtuesib ki npojgiu etqdb auqr rlqjgh jn vpngvw. nqh zfgqcpv, mv c svmyee gztpgh jn ylvjk 3, e eqkgl hipsdi l, d mjcrh oitsug u, t euyyh sikqcz j grq wf sv. vxz dokrrÃ¨ii kkfcmx lnw jidghvt ierwrv kkfcmxw vr jiywuikk avxy hqhvzzkrg wymnv lvtaif.</span><br><span class="line"></span><br><span class="line">xf ivehtxz, e gespm qv vtvlnfvxa eqi jk yfiu, xmtczl g xnflpi tuxbg, zvkvrÃ¨zg ilcgvr si zqiuiÃ¨zk xnfci. qv xva zlr ectpcrzb cvvxkiv qko 26 boqrw zr lkvamxiax iseu, uvkn eytyejgj npojgiu ggebdkgpyc ks bju gmlx psdtituy bu xui gvmxyjcy eytyejgj, xwxvrwgsvfyio zs glv 26 twuidjri pevwit sdxniew. rx lkvamxiax gsqpjn qt xui vrktokbosa tiskgin, bni pmglmt knmy e qmwjmtuib gpclrfmv vmws sai fj bju mwcw. glv etrxvjkx hwvh iv uvkn tbmex lgfzvjw br r vmruvbort ovceqhy.[koxnxzsv puzlkh]</span><br><span class="line"></span><br><span class="line">ssi ifccktk, whtgsag jciz xui gpikdomdx gs si mpsmgvxrh zw</span><br><span class="line"></span><br><span class="line">ivjvkqeghrav.</span><br><span class="line">vxz xkvfse wmptdvm xui diauqbm ilbsjia c azgcseh rrl tukmgxf mk yvvyg qz qnxtlmu jcm riakkl wh jcm vpnmexmzj, awx ikedttg, jcm qilafvl &quot;nuhwt&quot;:</span><br><span class="line"></span><br><span class="line">prqfrtgcjvri</span><br><span class="line">retl zqm nbgvgw nmbj q fme prxkiz. vxz zkwg sw xpg hje nsyhj xpg bzbziew r xw b (yi anmsxvh wttzz). gpglfyoj jcmxi nvv 26 oma hjey wusnr, i eeym cmyp lwm qdgg gw zeec sgon (lojsiiivv qgxneoikw) iu jcmxi nvv yvkgpm rigxvva kd opk orc jxzkdb, pkvr nlwb 5 muta: &#123;r, i, z, s, e&#125;. jtcw, &#x27;&#123;&#x27; vvj &#x27;zvkvrmtudabiecveaaxpp&#x27; grq &#x27;&#125;&#x27; jfv awsxmywvzv pmvjzzy ss xyi uginimi, fytgmuiddk prxkizu ea bni xip wbtyio cmyp si bcazv grq irgp ounagkr pvxbgh zvimclvvmf rt cymak zxa eemzkwcsehqpw fme vba. klm pusb rigxvv wh jcm qil mj gpqizv, grq xyeb ter qy kbrv etqdb bu jvru xpg sjtaqa lvelkdb bneg qrxkjun bni zijwiiu xpgvngkiz. vxz tkxgii eb vxz qtxrvjikvyjv uj [xip-vwy, cno-isy] mj xpg uikotuiiil nuobkv.</span><br><span class="line"></span><br><span class="line">ssi ifccktk, xui wmzuj gmzxrv fj bju ktgmaxvbb, c, yn xgmeiu aqvx g, bni smiwb nuobkv bj klm mut. bnieiwszg, hje r eah tstwci i uj glv zqiuiÃ¨zk wdyrvm chz cyiq, rrqmno g. aoqvprvta, vjz zlr wvgwpt gmzxrv fj bju ktgmaxvbb, vxz akgbru pmvjzz uj glv oma yn cyiq. xyi tgjomx eg vfa m cdy kuphqe x qu n. opk vrwk sn vxz xrevrkifv yn mtgvtyizgt dv g wvqzpit vvanmbr:</span><br><span class="line"></span><br><span class="line">gpikdomdx:	nxkekmqolgaa</span><br><span class="line">ovc:	tgcjvrizsepm</span><br><span class="line">eykpkvgiox:	tzvjxbisvelz</span><br><span class="line">fuxzetgmfr qu fzzlseqvh ja wjqtk gs klm ter qt xui kejnu xwxvrwgsvfyio zs glv oma, vdvjmak klm renqzmbr fj bju xqvlrvkifv bzbzie me xpcj mwc eah klmp knqtk glv gwnkhv&#x27;y pnfvp iu jcm vpnmexmzj. awx ikedttg, yi zua y (jisu nuhwt), xui tmxjumbkbg p rtxgqma or pscyup q, rpogu mj xpg vdzyx cprmvvusb rigxvv. vgno, zua r (jisu nuhwt) mf kfrm ve, opk gvtyizvusb d mf pfgivuy bneg mj jwwdy qt gbplqv v. jccy x vw klm uuxwth cprmvvusb rigxvv.</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å®é™…ä¸Š( â€¢Ì€ Ï‰ â€¢Ì )y</p>
<p><a target="_blank" rel="noopener" href="https://www.guballa.de/vigenere-solver%E8%87%AA%E5%8A%A8%E8%A7%A3%E5%AF%86">https://www.guballa.de/vigenere-solverè‡ªåŠ¨è§£å¯†</a></p>
<p>ç›´æ¥å…¨æ”¾è¿›å»å°±ok</p>
<blockquote>
<p>flag, â€˜{â€˜ and â€˜vigenereisveryeasyhuhâ€™ and â€˜}â€™ </p>
</blockquote>
<p>tipï¼šè®ºå¥½å·¥å…·çš„é‡è¦æ€§ğŸ˜­</p>
<h2 id="little-RSA"><a href="#little-RSA" class="headerlink" title="little RSA"></a>little RSA</h2><p>ä¸‰â­CSICTF</p>
<p>keyï¼šFactor N</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">c=32949</span><br><span class="line">n=64741</span><br><span class="line">e=42667</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">c = 32949</span><br><span class="line">n = 64741</span><br><span class="line">e = 42667</span><br><span class="line">p = 101</span><br><span class="line">q = 641</span><br><span class="line">phi = (p - 1) * (q - 1)  # Ï†(n)</span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line">a = pow(c, d, n)  # cçš„dæ¬¡æ–¹ mod n</span><br><span class="line">print(a)</span><br></pre></td></tr></table></figure>

<h3 id="RSAç®€å•å…¥é—¨"><a href="#RSAç®€å•å…¥é—¨" class="headerlink" title="RSAç®€å•å…¥é—¨"></a>RSAç®€å•å…¥é—¨</h3><blockquote>
<p>||å‚è€ƒï¼šXwhite</p>
</blockquote>
<p>Ron Rivestã€Adi Shamirã€Leonard Adleman</p>
<p>RSAå°±æ˜¯ä»–ä»¬ä¸‰äººå§“æ°å¼€å¤´å­—æ¯æ‹¼åœ¨ä¸€èµ·ç»„æˆçš„, ä¸‰ä¸ªäººåå­—è¦æœ‰å°è±¡ï¼Œæœ‰äº›é¢˜ç›®ä¼šç”¨è¿™ä¸‰ä¸ªåå­—ï¼Œè¿™æ ·å¯ä»¥å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿåˆ¤æ–­é¢˜ç›®ã€‚</p>
<p>RSAå…¬å¼€å¯†é’¥å¯†ç ä½“åˆ¶çš„åŸç†æ˜¯ï¼šåŸºäºæ•°è®ºï¼Œæˆ‘ä»¬èƒ½çŸ¥é“éšä¾¿æ‰¾ä¸¤ä¸ªå¤§ç´ æ•°æ¯”è¾ƒç®€å•ï¼Œä½†æ˜¯å¦‚æœç»™å®šä¸¤ä¸ªå¤§ç´ æ•°çš„ä¹˜ç§¯æ¥è¿›è¡Œå› å¼åˆ†è§£æ˜¯åŠå…¶å›°éš¾çš„ï¼Œå› æ­¤å¯ä»¥å°†ä¹˜ç§¯å…¬å¼€ä½œä¸ºåŠ å¯†å¯†é’¥ã€‚</p>
<p>RSAå…¬å¼€å¯†é’¥å¯†ç ä½“åˆ¶çš„åŸç†æ˜¯ï¼šåŸºäºæ•°è®ºï¼Œæˆ‘ä»¬èƒ½çŸ¥é“éšä¾¿æ‰¾ä¸¤ä¸ªå¤§ç´ æ•°æ¯”è¾ƒç®€å•ï¼Œä½†æ˜¯å¦‚æœç»™å®šä¸¤ä¸ªå¤§ç´ æ•°çš„ä¹˜ç§¯æ¥è¿›è¡Œå› å¼åˆ†è§£æ˜¯åŠå…¶å›°éš¾çš„ï¼Œå› æ­¤å¯ä»¥å°†ä¹˜ç§¯å…¬å¼€ä½œä¸ºåŠ å¯†å¯†é’¥ã€‚</p>
<h4 id="RSAå…¬é’¥å¯†ç "><a href="#RSAå…¬é’¥å¯†ç " class="headerlink" title="RSAå…¬é’¥å¯†ç "></a>RSAå…¬é’¥å¯†ç </h4><p>RSAå…¬é’¥å¯†ç ä½“åˆ¶æè¿°å¦‚ä¸‹ï¼š<br> 1ï¼‰é€‰å–ä¸¤ä¸ªå¤§ç´ æ•°på’Œqï¼Œpå’Œqä¿å¯†<br> 2ï¼‰è®¡ç®—n&#x3D;pqï¼ŒÏ†(n)&#x3D;(p-1)(q-1)ï¼Œnå…¬å¼€ï¼ŒÏ†(n)ï¼ˆæ¬§æ‹‰å‡½æ•°å€¼ï¼‰ä¿å¯†<br> 3ï¼‰éšæœºé€‰å–æ­£æ•´æ•° 1&lt;e&lt;Ï†(n)ï¼Œæ»¡è¶³gcd(e,Ï†(n)) &#x3D; 1ï¼Œeæ˜¯å…¬å¼€çš„åŠ å¯†å¯†é’¥<br> 4ï¼‰è®¡ç®—dï¼Œæ»¡è¶³edâ‰¡1(modÏ†(n))ï¼Œdæ˜¯ä¿å¯†çš„è§£å¯†å¯†é’¥</p>
<p>åŠ å¯†å˜æ¢ï¼šc &#x3D; m^e mod n<br> è§£å¯†å˜æ¢ï¼šm &#x3D; c^d mod n</p>
<p>è™½ç„¶nï¼Œe æ˜¯å…¬å¼€çš„ï¼Œä½†æ˜¯è¦æƒ³çŸ¥é“ d çš„å€¼ï¼Œå¿…é¡»è¦å°† n åˆ†è§£æ¥è®¡ç®—å‡º n çš„æ¬§æ‹‰å‡½æ•°å€¼ï¼Œè€Œ n æ˜¯ä¸¤ä¸ªå¤§ç´ æ•° pï¼Œq çš„ç§¯, å‰é¢è¯´è¿‡åˆ†è§£æ˜¯åŠå…¶å›°éš¾çš„ã€‚ ä½†æ˜¯å¯¹äºç‰¹å®šçš„æƒ…å†µå¯ä»¥ä½¿ç”¨ç‰¹æ®Šæ–¹æ³•è¿›è¡Œåˆ†è§£ã€‚<br> ä¸Šæ–‡ä»¥åŠä¸‹æ–‡ä¼šæ¶‰åŠåˆ°ä¸€äº›å…·ä½“çš„æ•°è®ºçŸ¥è¯†ï¼Œä¾‹å¦‚ï¼šä¸­å›½å‰©ä½™å®šç†ï¼ŒåŒä½™æ±‚ä½™è¿ç®—ï¼Œæ¬§æ‹‰å‡½æ•°ç­‰ï¼Œå¤§å®¶å¯ä»¥è‡ªè¡ŒæŸ¥è¯¢æˆ–è€…é€šè¿‡ã€Šä¿¡æ¯å®‰å…¨æ•°å­¦åŸºç¡€ã€‹æˆ–ã€Šç°ä»£å¯†ç å­¦ã€‹è¿›è¡Œè‡ªå­¦ï¼Œæœ¬æ–‡ä¸»è¦é’ˆå¯¹CTFæ¯”èµ›ä¸­å…³äºRSAå¸¸è§çš„é¢˜å‹è®²è§£ã€‚</p>
<h4 id="RSAå¸¸è§é¢˜å‹"><a href="#RSAå¸¸è§é¢˜å‹" class="headerlink" title="RSAå¸¸è§é¢˜å‹"></a>RSAå¸¸è§é¢˜å‹</h4><h5 id="æœ€ç®€å•çš„"><a href="#æœ€ç®€å•çš„" class="headerlink" title="æœ€ç®€å•çš„"></a>æœ€ç®€å•çš„</h5><p>è§£å†³ RSA é¢˜ç›®æœ€ç®€å•ï¼Œæœ€æš´åŠ›ï¼Œå°±æ˜¯ç›´æ¥åˆ†è§£ nã€‚å¦‚æœèƒ½å¤Ÿå°† n åˆ†è§£æˆåŠŸï¼Œå¾—åˆ° pï¼Œq çš„å–å€¼ï¼Œé‚£ä¹ˆå¯æ±‚Ï†(n).  Ï†(n)&#x3D;(p-1)(q-1)<br> åˆ©ç”¨eï¼Œd ä¸ n çš„æ¬§æ‹‰å‡½æ•°æ»¡è¶³ edâ‰¡1(modÏ†(n))<br> é€šè¿‡æ¬§å‡ é‡Œå¾—ç®—æ³•å¯ä»¥é€šè¿‡ e ä¸ n çš„æ¬§æ‹‰å‡½æ•°å€¼ä»è€Œæ±‚å‡º dï¼Œè®¡ç®—å‡ºè§£å¯†å¯†é’¥ã€‚<br> æ‰€ä»¥åœ¨çŸ¥é“ eï¼Œpï¼Œq çš„æƒ…å†µä¸‹ï¼Œå°±å¯ä»¥è§£å‡º dï¼ˆå…¶å®å•¥éƒ½ç»™äº†ï¼Œå°±è®©ä½ ä»£æ•°è®¡ç®—äº†ï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">p = 3487583947589437589237958723892346254777</span><br><span class="line">q = 8767867843568934765983476584376578389</span><br><span class="line">e = 65537</span><br><span class="line">print gmpy2.invert(e, (p-1)*(q-1))</span><br><span class="line">#æ±‚d</span><br></pre></td></tr></table></figure>

<h5 id="åˆ©ç”¨å…¬çº¦æ•°åˆ†è§£n"><a href="#åˆ©ç”¨å…¬çº¦æ•°åˆ†è§£n" class="headerlink" title="åˆ©ç”¨å…¬çº¦æ•°åˆ†è§£n"></a>åˆ©ç”¨å…¬çº¦æ•°åˆ†è§£n</h5><p>å¦‚æœåœ¨ä¸¤æ¬¡åŠ å¯†è¿‡ç¨‹ä¸­ä½¿ç”¨çš„n1å’Œn2å…·æœ‰ç›¸åŒçš„ç´ å› å­ï¼Œé‚£ä¹ˆå¯ä»¥åˆ©ç”¨æ¬§å‡ é‡Œå¾—ç®—æ³•ç›´æ¥å°†n1å’Œn2åˆ†è§£ã€‚é€šè¿‡æ¬§å‡ é‡Œå¾—ç®—æ³•å¯ä»¥ç›´æ¥æ±‚å‡ºn1å’Œn2çš„ä¸€ä¸ªæœ€å¤§å…¬çº¦æ•°pï¼š<br> gcd(n1,n2)&#x3D;p<br> è¿™æ ·çš„è¯<br> q1 &#x3D; n1 &#x2F; p<br> q2 &#x3D; n2 &#x2F; p</p>
<blockquote>
<p>egï¼š2020-BJDCTF-Cypto-rsa</p>
</blockquote>
<p>é¢˜ç›®æç¤ºe&#x3D;52361 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import getPrime,bytes_to_long</span><br><span class="line"></span><br><span class="line">flag=open(&quot;flag&quot;,&quot;rb&quot;).read()</span><br><span class="line"></span><br><span class="line">p=getPrime(1024)</span><br><span class="line">q=getPrime(1024)</span><br><span class="line">assert(e&lt;100000)</span><br><span class="line">n=p*q</span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line">c=pow(m,e,n)</span><br><span class="line">print c,n</span><br><span class="line">print pow(294,e,n)</span><br><span class="line"></span><br><span class="line">p=getPrime(1024)</span><br><span class="line">n=p*q</span><br><span class="line">m=bytes_to_long(&quot;BJD&quot;*32)</span><br><span class="line">c=pow(m,e,n)</span><br><span class="line">print c,n</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">output:</span><br><span class="line">12641635617803746150332232646354596292707861480200207537199141183624438303757120570096741248020236666965755798009656547738616399025300123043766255518596149348930444599820675230046423373053051631932557230849083426859490183732303751744004874183062594856870318614289991675980063548316499486908923209627563871554875612702079100567018698992935818206109087568166097392314105717555482926141030505639571708876213167112187962584484065321545727594135175369233925922507794999607323536976824183162923385005669930403448853465141405846835919842908469787547341752365471892495204307644586161393228776042015534147913888338316244169120  13508774104460209743306714034546704137247627344981133461801953479736017021401725818808462898375994767375627749494839671944543822403059978073813122441407612530658168942987820256786583006947001711749230193542370570950705530167921702835627122401475251039000775017381633900222474727396823708695063136246115652622259769634591309421761269548260984426148824641285010730983215377509255011298737827621611158032976420011662547854515610597955628898073569684158225678333474543920326532893446849808112837476684390030976472053905069855522297850688026960701186543428139843783907624317274796926248829543413464754127208843070331063037</span><br><span class="line">381631268825806469518166370387352035475775677163615730759454343913563615970881967332407709901235637718936184198930226303761876517101208677107311006065728014220477966000620964056616058676999878976943319063836649085085377577273214792371548775204594097887078898598463892440141577974544939268247818937936607013100808169758675042264568547764031628431414727922168580998494695800403043312406643527637667466318473669542326169218665366423043579003388486634167642663495896607282155808331902351188500197960905672207046579647052764579411814305689137519860880916467272056778641442758940135016400808740387144508156358067955215018</span><br><span class="line">979153370552535153498477459720877329811204688208387543826122582132404214848454954722487086658061408795223805022202997613522014736983452121073860054851302343517756732701026667062765906277626879215457936330799698812755973057557620930172778859116538571207100424990838508255127616637334499680058645411786925302368790414768248611809358160197554369255458675450109457987698749584630551177577492043403656419968285163536823819817573531356497236154342689914525321673807925458651854768512396355389740863270148775362744448115581639629326362342160548500035000156097215446881251055505465713854173913142040976382500435185442521721  12806210903061368369054309575159360374022344774547459345216907128193957592938071815865954073287532545947370671838372144806539753829484356064919357285623305209600680570975224639214396805124350862772159272362778768036844634760917612708721787320159318432456050806227784435091161119982613987303255995543165395426658059462110056431392517548717447898084915167661172362984251201688639469652283452307712821398857016487590794996544468826705600332208535201443322267298747117528882985955375246424812616478327182399461709978893464093245135530135430007842223389360212803439850867615121148050034887767584693608776323252233254261047</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ä»é¢˜ç›®é™„ä»¶çš„task,pyæå–æ‰€éœ€æ•°æ®</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line">c1 = 12641635617803746150332232646354596292707861480200207537199141183624438303757120570096741248020236666965755798009656547738616399025300123043766255518596149348930444599820675230046423373053051631932557230849083426859490183732303751744004874183062594856870318614289991675980063548316499486908923209627563871554875612702079100567018698992935818206109087568166097392314105717555482926141030505639571708876213167112187962584484065321545727594135175369233925922507794999607323536976824183162923385005669930403448853465141405846835919842908469787547341752365471892495204307644586161393228776042015534147913888338316244169120</span><br><span class="line">n1 = 13508774104460209743306714034546704137247627344981133461801953479736017021401725818808462898375994767375627749494839671944543822403059978073813122441407612530658168942987820256786583006947001711749230193542370570950705530167921702835627122401475251039000775017381633900222474727396823708695063136246115652622259769634591309421761269548260984426148824641285010730983215377509255011298737827621611158032976420011662547854515610597955628898073569684158225678333474543920326532893446849808112837476684390030976472053905069855522297850688026960701186543428139843783907624317274796926248829543413464754127208843070331063037</span><br><span class="line">c2 = 97915337055253515349847745972087732981120468820838754382612258213240421484845495472248708665806140879522380502220299761352201473698345</span><br><span class="line">n2 = 12806210903061368369054309575159360374022344774547459345216907128193957592938071815865954073287532545947370671838372144806539753829484356064919357285623305209600680570975224639214396805124350862772159272362778768036844634760917612708721787320159318432456050806227784435091161119982613987303255995543165395426658059462110056431392517548717447898084915167661172362984251201688639469652283452307712821398857016487590794996544468826705600332208535201443322267298747117528882985955375246424812616478327182399461709978893464093245135530135430007842223389360212803439850867615121148050034887767584693608776323252233254261047</span><br><span class="line">e = 52361</span><br><span class="line">p = gmpy2.gcd(n1, n2)</span><br><span class="line">q = n1 // p</span><br><span class="line">phi = (p - 1) * (q - 1)</span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line"></span><br><span class="line">flag = pow(c1, d, n1)</span><br><span class="line"></span><br><span class="line">print(bytes.fromhex(hex(flag)[2:]))</span><br></pre></td></tr></table></figure>

<p>æœ€ç»ˆflagä¸º<code>BJD&#123;p_is_common_divisor&#125;</code><br>å½“ç„¶&#x3D;&#x3D;eå¦‚æœæ²¡æœ‰æç¤ºå‘¢&#x3D;&#x3D;ï¼Œeå°äº100000ï¼Œåˆæœ‰<code>pow(294,e,n)</code>ï¼Œå¯ä»¥é€šè¿‡çˆ†ç ´eçš„å–å€¼å¾ˆå¿«å¾—åˆ°e,ä»£ç å¦‚ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">output=381631268825806469518166370387352035475775677163615730759454343913563615970881967332407709901235637718936184198930226303761876517101208677107311006065728014220477966000620964056616058676999878976943319063836649085085377577273214792371548775204594097887078898598463892440141577974544939268247818937936607013100808169758675042264568547764031628431414727922168580998494695800403043312406643527637667466318473669542326169218665366423043579003388486634167642663495896607282155808331902351188500197960905672207046579647052764579411814305689137519860880916467272056778641442758940135016400808740387144508156358067955215018</span><br><span class="line">for i in range(100000):</span><br><span class="line">    res=pow(294,i,n1)</span><br><span class="line">    if (res==output):</span><br><span class="line">        print(i)</span><br><span class="line">        e=i</span><br><span class="line">        break</span><br></pre></td></tr></table></figure>

<h5 id="å…±æ¨¡æ”»å‡»"><a href="#å…±æ¨¡æ”»å‡»" class="headerlink" title="å…±æ¨¡æ”»å‡»"></a>å…±æ¨¡æ”»å‡»</h5><p>rsa modulo-related attacks</p>
<p>å¦‚æœä½¿ç”¨äº†ç›¸åŒçš„æ¨¡ n å¯¹ç›¸åŒçš„æ˜æ–‡ m è¿›è¡Œäº†åŠ å¯†ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ä¸åˆ†è§£ n çš„æƒ…å†µä¸‹è¿˜åŸå‡ºæ˜æ–‡ m çš„å€¼ã€‚å³<br> c1 &#x3D; m^e1 mod n<br> c2 &#x3D; m^e2 mod n<br>æ­¤æ—¶ä¸éœ€è¦åˆ†è§£nï¼Œä¹Ÿä¸éœ€è¦æ±‚è§£ç§é’¥ï¼Œå¦‚æœe1å’Œe2äº’ç´ ï¼Œé‚£ä¹ˆå°±å¯ä»¥åˆ©ç”¨å…±æ¨¡æ”»å‡»åˆ©ç”¨ä¸¤ä¸ªå¯†æ–‡å’Œå…¬é’¥ç»™å‡ºçš„æƒ…å†µä¸‹è¿˜åŸå¯†æ–‡m</p>
<p>ç®€å•çš„è¿‡ç¨‹ï¼Œå‰ææ¡ä»¶ä¸¤ä¸ªåŠ å¯†æŒ‡æ•°äº’è´¨<br> gcd(e1,e2) &#x3D; 1ï¼Œé‚£ä¹ˆs2å­˜åœ¨ï¼Œåˆ™ï¼š<br> s1 * e1 + s2 * e2 &#x3D; 1<br> å› ä¸ºc1 &#x3D; m^e1 mod nï¼Œc2 &#x3D; m^e2 mod n<br> ä»£å…¥åŒ–ç®€å¯ä»¥å¾—å‡º c1^s2 * c2^s2 â‰¡ m mod n</p>
<blockquote>
<p>egï¼š2020-BJDCTF-Crypto-rsa_output</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;21058339337354287847534107544613605305015441090508924094198816691219103399526800112802416383088995253908857460266726925615826895303377801614829364034624475195859997943146305588315939130777450485196290766249612340054354622516207681542973756257677388091926549655162490873849955783768663029138647079874278240867932127196686258800146911620730706734103611833179733264096475286491988063990431085380499075005629807702406676707841324660971173253100956362528346684752959937473852630145893796056675793646430793578265418255919376323796044588559726703858429311784705245069845938316802681575653653770883615525735690306674635167111,2767&#125;</span><br><span class="line"></span><br><span class="line">&#123;21058339337354287847534107544613605305015441090508924094198816691219103399526800112802416383088995253908857460266726925615826895303377801614829364034624475195859997943146305588315939130777450485196290766249612340054354622516207681542973756257677388091926549655162490873849955783768663029138647079874278240867932127196686258800146911620730706734103611833179733264096475286491988063990431085380499075005629807702406676707841324660971173253100956362528346684752959937473852630145893796056675793646430793578265418255919376323796044588559726703858429311784705245069845938316802681575653653770883615525735690306674635167111,3659&#125;</span><br><span class="line"></span><br><span class="line">message1=20152490165522401747723193966902181151098731763998057421967155300933719378216342043730801302534978403741086887969040721959533190058342762057359432663717825826365444996915469039056428416166173920958243044831404924113442512617599426876141184212121677500371236937127571802891321706587610393639446868836987170301813018218408886968263882123084155607494076330256934285171370758586535415136162861138898728910585138378884530819857478609791126971308624318454905992919405355751492789110009313138417265126117273710813843923143381276204802515910527468883224274829962479636527422350190210717694762908096944600267033351813929448599</span><br><span class="line"></span><br><span class="line">message2=11298697323140988812057735324285908480504721454145796535014418738959035245600679947297874517818928181509081545027056523790022598233918011261011973196386395689371526774785582326121959186195586069851592467637819366624044133661016373360885158956955263645614345881350494012328275215821306955212788282617812686548883151066866149060363482958708364726982908798340182288702101023393839781427386537230459436512613047311585875068008210818996941460156589314135010438362447522428206884944952639826677247819066812706835773107059567082822312300721049827013660418610265189288840247186598145741724084351633508492707755206886202876227</span><br></pre></td></tr></table></figure>

<p>keyï¼šè§‚å¯Ÿç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªçš„nä¸€æ ·, ä¸åŒçš„æ˜¯e, å¯åˆ¤æ–­æ˜¯å…±æ¨¡æ”»å‡»</p>
<p>æ ¹æ®é¢˜ç›®ç»™å‡ºçš„æ–‡ä»¶ï¼Œæå–æ‰€éœ€å‚æ•°ï¼Œå†™å‡ºdecryptè„šæœ¬</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">import  gmpy2</span><br><span class="line">import  binascii</span><br><span class="line">import  rsa</span><br><span class="line">import math</span><br><span class="line">def exgcd(m, n, x, y):</span><br><span class="line">    if n == 0:</span><br><span class="line">        x = 1</span><br><span class="line">        y = 0</span><br><span class="line">        return (m, x, y)</span><br><span class="line">    a1 = b = 1</span><br><span class="line">    a = b1 = 0</span><br><span class="line">    c = m</span><br><span class="line">    d = n</span><br><span class="line">    q = int(c / d)</span><br><span class="line">    r = c % d</span><br><span class="line">    while r:</span><br><span class="line">        c = d</span><br><span class="line">        d = r</span><br><span class="line">        t = a1</span><br><span class="line">        a1 = a</span><br><span class="line">        a = t - q * a</span><br><span class="line">        t = b1</span><br><span class="line">        b1 = b</span><br><span class="line">        b = t - q * b</span><br><span class="line">        q = int(c / d)</span><br><span class="line">        r = c % d</span><br><span class="line">    x = a</span><br><span class="line">    y = b</span><br><span class="line">    return (d, x, y)#æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•</span><br><span class="line">c1=20152490165522401747723193966902181151098731763998057421967155300933719378216342043730801302534978403741086887969040721959533190058342762057359432663717825826365444996915469039056428416166173920958243044831404924113442512617599426876141184212121677500371236937127571802891321706587610393639446868836987170301813018218408886968263882123084155607494076330256934285171370758586535415136162861138898728910585138378884530819857478609791126971308624318454905992919405355751492789110009313138417265126117273710813843923143381276204802515910527468883224274829962479636527422350190210717694762908096944600267033351813929448599</span><br><span class="line">c2=11298697323140988812057735324285908480504721454145796535014418738959035245600679947297874517818928181509081545027056523790022598233918011261011973196386395689371526774785582326121959186195586069851592467637819366624044133661016373360885158956955263645614345881350494012328275215821306955212788282617812686548883151066866149060363482958708364726982908798340182288702101023393839781427386537230459436512613047311585875068008210818996941460156589314135010438362447522428206884944952639826677247819066812706835773107059567082822312300721049827013660418610265189288840247186598145741724084351633508492707755206886202876227</span><br><span class="line">e1=2767</span><br><span class="line">e2=3659</span><br><span class="line">n=21058339337354287847534107544613605305015441090508924094198816691219103399526800112802416383088995253908857460266726925615826895303377801614829364034624475195859997943146305588315939130777450485196290766249612340054354622516207681542973756257677388091926549655162490873849955783768663029138647079874278240867932127196686258800146911620730706734103611833179733264096475286491988063990431085380499075005629807702406676707841324660971173253100956362528346684752959937473852630145893796056675793646430793578265418255919376323796044588559726703858429311784705245069845938316802681575653653770883615525735690306674635167111</span><br><span class="line"></span><br><span class="line">ans=exgcd(e1,e2,0,0)</span><br><span class="line">s1=ans[1]</span><br><span class="line">s2=ans[2]</span><br><span class="line">m=(gmpy2.powmod(c1,s1,n)*gmpy2.powmod(c2,s2,n))%n</span><br><span class="line">#powmod()å‡½æ•°çœŸé¦™,åˆ†æ•°å–æ¨¡ä¹Ÿå¯ç›´æ¥ç®—,ä¸€å¼€å§‹ä¸çŸ¥é“è¿˜å»æ‰¾äº†å¾ˆå¤šçš„ç®—æ³•çŸ¥è¯†</span><br><span class="line">print(binascii.unhexlify(hex(m)[2:]))</span><br><span class="line"></span><br><span class="line">#BJD&#123;r3a_C0mmoN_moD@_4ttack&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>powmod()å‡½æ•°</p>
</blockquote>
<h5 id="è€ƒæ•°å­¦bï¼ˆï¿£â–½ï¿£ï¼‰d"><a href="#è€ƒæ•°å­¦bï¼ˆï¿£â–½ï¿£ï¼‰d" class="headerlink" title="è€ƒæ•°å­¦bï¼ˆï¿£â–½ï¿£ï¼‰d"></a>è€ƒæ•°å­¦bï¼ˆï¿£â–½ï¿£ï¼‰d</h5><blockquote>
<p>2020-BJDCTF-Crypto-EasyRSA</p>
</blockquote>
<p>keyï¼šDerivative()å’ŒFraction()çš„ä½œç”¨</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import getPrime,bytes_to_long</span><br><span class="line">from sympy import Derivative</span><br><span class="line">from fractions import Fraction</span><br><span class="line">from secret import flag</span><br><span class="line"></span><br><span class="line">p=getPrime(1024)</span><br><span class="line">q=getPrime(1024)</span><br><span class="line">e=65537</span><br><span class="line">n=p*q</span><br><span class="line">z=Fraction(1,Derivative(arctan(p),p))-Fraction(1,Derivative(arth(q),q))</span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line">c=pow(m,e,n)</span><br><span class="line">print(c,z,n)</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">output:</span><br><span class="line">7922547866857761459807491502654216283012776177789511549350672958101810281348402284098310147796549430689253803510994877420135537268549410652654479620858691324110367182025648788407041599943091386227543182157746202947099572389676084392706406084307657000104665696654409155006313203957292885743791715198781974205578654792123191584957665293208390453748369182333152809882312453359706147808198922916762773721726681588977103877454119043744889164529383188077499194932909643918696646876907327364751380953182517883134591810800848971719184808713694342985458103006676013451912221080252735948993692674899399826084848622145815461035</span><br><span class="line">32115748677623209667471622872185275070257924766015020072805267359839059393284316595882933372289732127274076434587519333300142473010344694803885168557548801202495933226215437763329280242113556524498457559562872900811602056944423967403777623306961880757613246328729616643032628964072931272085866928045973799374711846825157781056965164178505232524245809179235607571567174228822561697888645968559343608375331988097157145264357626738141646556353500994924115875748198318036296898604097000938272195903056733565880150540275369239637793975923329598716003350308259321436752579291000355560431542229699759955141152914708362494482</span><br><span class="line">15310745161336895413406690009324766200789179248896951942047235448901612351128459309145825547569298479821101249094161867207686537607047447968708758990950136380924747359052570549594098569970632854351825950729752563502284849263730127586382522703959893392329333760927637353052250274195821469023401443841395096410231843592101426591882573405934188675124326997277775238287928403743324297705151732524641213516306585297722190780088180705070359469719869343939106529204798285957516860774384001892777525916167743272419958572055332232056095979448155082465977781482598371994798871917514767508394730447974770329967681767625495394441</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Derivativeæ˜¯è¡¨ç¤ºå¯¼å‡½æ•°çš„ç±»ï¼Œå®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯éœ€è¦è¿›è¡Œæ±‚å¯¼çš„æ•°å­¦å‡½æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ±‚å¯¼çš„è‡ªå˜é‡ï¼Œæ³¨æ„ï¼šDerivativeæ‰€å¾—åˆ°çš„æ˜¯ä¸€ä¸ªå¯¼å‡½æ•°ï¼Œå®ƒä¸ä¼šè¿›è¡Œæ±‚å¯¼è¿ç®—ï¼›ä¾‹ï¼št&#x3D;Derivative(sin(x),x)</p>
<p>Fraction()ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯è¿›è¡Œåˆ†æ•°è¿ç®—ï¼Œä¾‹ï¼šFraction(2,8)ç­‰äº0.25</p>
<p>ç„¶åå¯¹å¯¹arctan(x)å’Œarth(x)æ±‚å¯¼</p>
<p>ç”±æ­¤å¯¹åŠ å¯†è„šæœ¬ä¸­çš„zåŒ–ç®€å¾—åˆ°ï¼šp^2 + q^2</p>
<p>decrypt</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: UTF-8 -*-</span><br><span class="line">from gmpy2 import *</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">import sympy</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">e=65537</span><br><span class="line">c = 7922547866857761459807491502654216283012776177789511549350672958101810281348402284098310147796549430689253803510994877420135537268549410652654479620858691324110367182025648788407041599943091386227543182157746202947099572389676084392706406084307657000104665696654409155006313203957292885743791715198781974205578654792123191584957665293208390453748369182333152809882312453359706147808198922916762773721726681588977103877454119043744889164529383188077499194932909643918696646876907327364751380953182517883134591810800848971719184808713694342985458103006676013451912221080252735948993692674899399826084848622145815461035</span><br><span class="line">z = 32115748677623209667471622872185275070257924766015020072805267359839059393284316595882933372289732127274076434587519333300142473010344694803885168557548801202495933226215437763329280242113556524498457559562872900811602056944423967403777623306961880757613246328729616643032628964072931272085866928045973799374711846825157781056965164178505232524245809179235607571567174228822561697888645968559343608375331988097157145264357626738141646556353500994924115875748198318036296898604097000938272195903056733565880150540275369239637793975923329598716003350308259321436752579291000355560431542229699759955141152914708362494482</span><br><span class="line">n = 15310745161336895413406690009324766200789179248896951942047235448901612351128459309145825547569298479821101249094161867207686537607047447968708758990950136380924747359052570549594098569970632854351825950729752563502284849263730127586382522703959893392329333760927637353052250274195821469023401443841395096410231843592101426591882573405934188675124326997277775238287928403743324297705151732524641213516306585297722190780088180705070359469719869343939106529204798285957516860774384001892777525916167743272419958572055332232056095979448155082465977781482598371994798871917514767508394730447974770329967681767625495394441</span><br><span class="line">s = time.clock()</span><br><span class="line"></span><br><span class="line">p = sympy.Symbol(&#x27;p&#x27;)#æ–¹ç¨‹ç»„å®šä¹‰å˜é‡</span><br><span class="line">q = sympy.Symbol(&#x27;q&#x27;)</span><br><span class="line">f1 = p**2+q**2-z</span><br><span class="line">f2 = p*q-n</span><br><span class="line">result = sympy.solve([f1,f2],[p,q])</span><br><span class="line">#print result</span><br><span class="line">p = int(result[2][0])</span><br><span class="line">q = int(result[2][1])</span><br><span class="line"></span><br><span class="line">phi = (p-1)*(q-1)</span><br><span class="line">d = invert(e,phi)</span><br><span class="line">m = pow(c,d,p*q)</span><br><span class="line">print long_to_bytes(m)</span><br><span class="line">print &#x27;[!]Timer:&#x27;, round(time.clock() - s, 2)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸Šæ˜¯RSAç®€å•å…¥é—¨ï¼Œå½“ç„¶å¸¸è§ç±»å‹è¿˜æœ‰ä½åŠ å¯†æŒ‡æ•°æ”»å‡»ï¼Œä½è§£å¯†æŒ‡æ•°æ”»ï¼ŒCoppersmith ç›¸å…³æ”»å‡»ï¼Œä¾§ä¿¡é“ï¼Œé€‰æ‹©æ˜å¯†æ–‡æ”»å‡»ç­‰ç­‰ã€‚åç»­æ–‡ç« ä¼šé€æ­¥è¡¥å……å¹¶ä¸”ä¼šå†å¤šæ•´ç†å‡ é“CTFå‡ºç°è¿‡çš„ä¾‹é¢˜,è¿˜æœ‰ä¸€äº›å¸¸è§ç±»å‹çš„å˜å½¢ï¼Œæ¯”å¦‚RSAå…±æ¨¡ e1ï¼Œe2ä¸äº’ç´ æ€ä¹ˆåŠï¼Œåç»­ä¼šä»‹ç»ã€‚</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="http://hackerv27.github.io">hackerv27</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="http://hackerv27.github.io/2022/06/26/ctfhub/">http://hackerv27.github.io/2022/06/26/ctfhub/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="http://hackerv27.github.io" target="_blank">æ—©å®‰Flag</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/wp/">wp</a></div><div class="post_share"><div class="social-share" data-image="/img/7.png" data-sites="wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/gh/overtrue/share.js@master/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> æ‰“èµ</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/function%20link()%20%7B%20%5Bnative%20code%5D%20%7D" target="_blank"><img class="post-qr-code-img" src="/"/></a><div class="post-qr-code-desc"></div></li><li class="reward-item"><a href="/function%20link()%20%7B%20%5Bnative%20code%5D%20%7D" target="_blank"><img class="post-qr-code-img" src="/"/></a><div class="post-qr-code-desc"></div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/06/27/cry/"><img class="prev-cover" src="/img/9.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">Cryptoæ•´ç†</div></div></a></div><div class="next-post pull-right"><a href="/2022/06/20/python/"><img class="next-cover" src="/img/11.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">çœ‹å¿ƒæƒ…é¡¹ç›®</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><div><a href="/2022/06/20/ctf/" title="CTFå›½èµ›wp"><img class="cover" src="/img/6.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-06-20</div><div class="title">CTFå›½èµ›wp</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> è¯„è®º</span></div><div id="comment-switch"><span class="first-comment">Valine</span><span class="switch-btn"></span><span class="second-comment">Disqus</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div><div><div id="disqus_thread"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/1.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">hackerv27</div><div class="author-info__description">( â€¢Ì€ Ï‰ â€¢Ì )y</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">6</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">3</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/hackerv27"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/hackerv27" target="_blank" title="Github"><i class="fab fa-github"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">æˆ‘è¦ç§ä¸€ç‰‡é’é’è‰åŸ</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#CTFhub"><span class="toc-number">1.</span> <span class="toc-text">CTFhub</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#you-raise-me-up"><span class="toc-number">1.1.</span> <span class="toc-text">you_raise_me_up</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#binascii-%E2%80%94-%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%92%8C-ASCII-%E7%A0%81%E4%BA%92%E8%BD%AC"><span class="toc-number">1.1.0.0.0.1.</span> <span class="toc-text">binascii â€” äºŒè¿›åˆ¶å’Œ ASCII ç äº’è½¬</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sage%E4%B9%8B%E7%A6%BB%E6%95%A3%E5%AF%B9%E6%95%B0%E6%B1%82%E8%A7%A3"><span class="toc-number">1.1.1.</span> <span class="toc-text">sageä¹‹ç¦»æ•£å¯¹æ•°æ±‚è§£</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#shanghai"><span class="toc-number">1.2.</span> <span class="toc-text">shanghai</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#little-RSA"><span class="toc-number">1.3.</span> <span class="toc-text">little RSA</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#RSA%E7%AE%80%E5%8D%95%E5%85%A5%E9%97%A8"><span class="toc-number">1.3.1.</span> <span class="toc-text">RSAç®€å•å…¥é—¨</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#RSA%E5%85%AC%E9%92%A5%E5%AF%86%E7%A0%81"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">RSAå…¬é’¥å¯†ç </span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#RSA%E5%B8%B8%E8%A7%81%E9%A2%98%E5%9E%8B"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">RSAå¸¸è§é¢˜å‹</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9C%80%E7%AE%80%E5%8D%95%E7%9A%84"><span class="toc-number">1.3.1.2.1.</span> <span class="toc-text">æœ€ç®€å•çš„</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E5%85%AC%E7%BA%A6%E6%95%B0%E5%88%86%E8%A7%A3n"><span class="toc-number">1.3.1.2.2.</span> <span class="toc-text">åˆ©ç”¨å…¬çº¦æ•°åˆ†è§£n</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB"><span class="toc-number">1.3.1.2.3.</span> <span class="toc-text">å…±æ¨¡æ”»å‡»</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%80%83%E6%95%B0%E5%AD%A6b%EF%BC%88%EF%BF%A3%E2%96%BD%EF%BF%A3%EF%BC%89d"><span class="toc-number">1.3.1.2.4.</span> <span class="toc-text">è€ƒæ•°å­¦bï¼ˆï¿£â–½ï¿£ï¼‰d</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/06/27/cry/" title="Cryptoæ•´ç†">Cryptoæ•´ç†</a><time datetime="2022-06-27T14:37:44.000Z" title="å‘è¡¨äº 2022-06-27 22:37:44">2022-06-27</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/06/26/ctfhub/" title="CTFhub">CTFhub</a><time datetime="2022-06-26T15:24:52.000Z" title="å‘è¡¨äº 2022-06-26 23:24:52">2022-06-26</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/06/20/python/" title="çœ‹å¿ƒæƒ…é¡¹ç›®">çœ‹å¿ƒæƒ…é¡¹ç›®</a><time datetime="2022-06-20T14:18:10.000Z" title="å‘è¡¨äº 2022-06-20 22:18:10">2022-06-20</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/06/20/ctf/" title="CTFå›½èµ›wp">CTFå›½èµ›wp</a><time datetime="2022-06-20T14:17:50.000Z" title="å‘è¡¨äº 2022-06-20 22:17:50">2022-06-20</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/06/20/flag/" title="flag">flag</a><time datetime="2022-06-20T12:20:53.000Z" title="å‘è¡¨äº 2022-06-20 20:20:53">2022-06-20</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 By hackerv27</div><div class="footer_custom_text">Hi, welcome to my <a target="_blank" rel="noopener" href="https://butterfly.js.org/">blog</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="èŠå¤©"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: '',
      appKey: '',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script>function loadDisqus () {
  var disqus_config = function () {
    this.page.url = 'http://hackerv27.github.io/2022/06/26/ctfhub/'
    this.page.identifier = '2022/06/26/ctfhub/'
    this.page.title = 'CTFhub'
  };

  window.disqusReset = () => {
    DISQUS.reset({
      reload: true,
      config: disqus_config
    })
  }

  if (window.DISQUS) disqusReset()
  else {
    (function() { 
      var d = document, s = d.createElement('script');
      s.src = 'https://.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  }
}

if ('Valine' === 'Disqus' || !false) {
  if (false) btf.loadComment(document.getElementById('disqus_thread'), loadDisqus)
  else loadDisqus()
} else {
  function loadOtherComment () {
    loadDisqus()
  }
}
</script></div><div class="aplayer no-destroy" data-id="60198" data-server="netease" data-type="playlist" data-fixed="true" data-autoplay="true"> </div><canvas class="fireworks" mobile="true"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script>(function(d, w, c) {
    w.ChatraID = 'PbGL3JSSSfT3Kbda4';
    var s = d.createElement('script');
    w[c] = w[c] || function() {
        (w[c].q = w[c].q || []).push(arguments);
    };
    s.async = true;
    s.src = 'https://call.chatra.io/chatra.js';
    if (d.head) d.head.appendChild(s);
})(document, window, 'Chatra');

if (true) {
  var chatBtnFn = () => {
    var chatBtn = document.getElementById("chat_btn")
    chatBtn.addEventListener("click", function(){
      Chatra('openChat')
    });
  }
  chatBtnFn()
} else {
  if (true) {
    function chatBtnHide () {
      Chatra('hide')
    }
    function chatBtnShow () {
      Chatra('show')
    }
  }
}</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer@1/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>